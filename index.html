<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>연구소 DB Project</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Noto Sans KR', sans-serif; word-break: keep-all; }
        .hidden { display: none; }
        .role-label.selected { background-color: #f59e0b; color: #1e293b; border-color: #d97706; }
        .modal-body::-webkit-scrollbar { width: 8px; height: 8px; }
        .modal-body::-webkit-scrollbar-track { background: #f1f5f9; }
        .modal-body::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 4px; }
        input:disabled, select:disabled, textarea:disabled { background-color: #f1f5f9; cursor: not-allowed; opacity: 0.7; }
        input[readonly] { background-color: #f1f5f9; }
        .loading-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background-color: rgba(255, 255, 255, 0.8); z-index: 1000;
            display: flex; align-items: center; justify-content: center;
        }
        .loader {
            border: 8px solid #f3f3f3; border-top: 8px solid #3498db;
            border-radius: 50%; width: 60px; height: 60px; animation: spin 2s linear infinite;
        }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
        
        .tooltip-icon {
            position: relative; margin-left: 6px; cursor: pointer; color: #94a3b8;
            border: 1px solid #e2e8f0; border-radius: 50%; width: 20px; height: 20px;
            display: inline-flex; justify-content: center; align-items: center;
            font-size: 12px; font-weight: bold; font-style: italic; user-select: none; transition: all 0.2s ease;
        }
        .tooltip-icon:hover { background-color: #1e293b; color: white; border-color: #1e293b; }
        #global-tooltip {
            visibility: hidden; width: 280px; background-color: #1e293b; color: #fff;
            text-align: left; border-radius: 6px; padding: 12px; position: fixed;
            z-index: 1001; opacity: 0; transition: opacity 0.2s; pointer-events: none;
            font-size: 13px; font-weight: 400; line-height: 1.6;
        }
        th, td, button, a { white-space: nowrap; }
        /* 전체 화면 사용 */
        .full-width-container { width: 100%; padding: 8px; }
        @media (min-width: 768px) { .full-width-container { padding: 16px; } }
    </style>
</head>
<body class="bg-slate-100 pb-20">

    <div id="loading-overlay" class="loading-overlay hidden">
        <div class="loader"></div>
    </div>
    
    <div id="global-tooltip"></div>

    <!-- 로그인 페이지 -->
    <div id="login-page">
        <div class="flex items-center justify-center min-h-screen">
            <div class="w-full max-w-md p-8 space-y-8 bg-white rounded-2xl shadow-xl">
                <header class="text-center">
                    <h1 class="text-3xl font-bold text-slate-800">연구소 DB Project</h1>
                    <p class="mt-2 text-sm text-slate-500">제작 : (주)한국FP센터 부설 중소기업경영연구소</p>
                </header>
                <form id="login-form" class="mt-8 space-y-6">
                    <div>
                        <label for="username" class="text-sm font-semibold text-slate-700">아이디 (성명)</label>
                        <input id="username" type="text" required class="mt-2 block w-full px-4 py-3 bg-slate-50 border rounded-lg" placeholder="가입하신 성명을 입력하세요">
                    </div>
                    <div>
                        <label for="password" class="text-sm font-semibold text-slate-700">전화번호 (비밀번호)</label>
                        <input id="password" type="password" required class="mt-2 block w-full px-4 py-3 bg-slate-50 border rounded-lg" placeholder="'-'를 제외한 전화번호를 입력하세요">
                    </div>
                    <div><button type="submit" class="w-full flex justify-center py-3 px-4 text-base font-bold rounded-lg text-white bg-slate-800 hover:bg-slate-900">로그인</button></div>
                </form>
                <div class="flex items-center justify-between gap-4">
                    <button type="button" onclick="showPage('register-page')" class="w-full text-center py-3 px-4 text-sm font-semibold rounded-lg text-slate-800 bg-slate-200 hover:bg-slate-300">회원가입</button>
                    <button type="button" onclick="showPage('admin-login-page')" class="w-full text-center py-3 px-4 text-sm font-semibold rounded-lg text-slate-800 bg-slate-200 hover:bg-slate-300">관리자페이지</button>
                </div>
                <div class="pt-4 border-t grid grid-cols-2 gap-4">
                    <a href="https://benefits-corp-homepage.netlify.app/" target="_blank" class="text-center py-3 px-4 text-sm font-semibold rounded-lg text-white bg-sky-600 hover:bg-sky-700">기업홈페이지 장점</a>
                    <button type="button" onclick="showPriceTableModal()" class="text-center py-3 px-4 text-sm font-semibold rounded-lg text-white bg-teal-600 hover:bg-teal-700">기업홈페이지 가격표</button>
                </div>
                
                <!-- 가격표 모달 -->
                <div id="price-table-modal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
                    <div class="bg-white rounded-2xl shadow-xl max-w-md w-full mx-4 overflow-hidden">
                        <div class="bg-teal-600 text-white px-6 py-4">
                            <h3 class="text-xl font-bold text-center">기업홈페이지 가격표</h3>
                        </div>
                        <div class="p-6">
                            <table class="w-full text-sm">
                                <tbody class="divide-y">
                                    <tr class="hover:bg-slate-50">
                                        <td class="py-3 font-semibold text-slate-700">제작비</td>
                                        <td class="py-3 text-right text-teal-600 font-bold">무료</td>
                                    </tr>
                                    <tr class="hover:bg-slate-50">
                                        <td class="py-3 font-semibold text-slate-700">유지/보수 비용</td>
                                        <td class="py-3 text-right text-teal-600 font-bold">없음</td>
                                    </tr>
                                    <tr class="hover:bg-slate-50">
                                        <td class="py-3 font-semibold text-slate-700">초기셋팅비</td>
                                        <td class="py-3 text-right font-bold">100만원</td>
                                    </tr>
                                    <tr class="hover:bg-slate-50">
                                        <td class="py-3 font-semibold text-slate-700">서버등록비 (1회)</td>
                                        <td class="py-3 text-right font-bold">10만원</td>
                                    </tr>
                                    <tr class="hover:bg-slate-50">
                                        <td class="py-3 font-semibold text-slate-700">월이용료</td>
                                        <td class="py-3 text-right font-bold">10만원</td>
                                    </tr>
                                    <tr class="hover:bg-slate-50">
                                        <td class="py-3 font-semibold text-slate-700">웹호스팅비</td>
                                        <td class="py-3 text-right text-slate-500">이용량에 따라 결정</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                        <div class="px-6 pb-6">
                            <button type="button" onclick="closePriceTableModal()" class="w-full py-3 bg-slate-800 hover:bg-slate-900 text-white font-bold rounded-lg">닫기</button>
                        </div>
                    </div>
                </div>
                
                <script>
                    function showPriceTableModal() {
                        document.getElementById('price-table-modal').classList.remove('hidden');
                    }
                    function closePriceTableModal() {
                        document.getElementById('price-table-modal').classList.add('hidden');
                    }
                    document.addEventListener('DOMContentLoaded', function() {
                        document.getElementById('price-table-modal')?.addEventListener('click', function(e) {
                            if (e.target === this) closePriceTableModal();
                        });
                    });
                </script>
            </div>
        </div>
    </div>
    
    <!-- 관리자 로그인 페이지 -->
    <div id="admin-login-page" class="hidden">
        <div class="flex items-center justify-center min-h-screen">
            <div class="w-full max-w-md p-8 space-y-8 bg-white rounded-2xl shadow-xl">
                <header class="text-center"><h1 class="text-3xl font-bold text-slate-800">관리자 로그인</h1></header>
                <form id="admin-login-form" class="mt-8 space-y-6">
                    <div>
                        <label for="admin-id" class="text-sm font-semibold text-slate-700">관리자 아이디</label>
                        <input id="admin-id" type="text" required class="mt-2 block w-full px-4 py-3 bg-slate-50 border rounded-lg" placeholder="아이디 입력">
                    </div>
                    <div>
                        <label for="admin-pw" class="text-sm font-semibold text-slate-700">관리자 비밀번호</label>
                        <input id="admin-pw" type="password" required class="mt-2 block w-full px-4 py-3 bg-slate-50 border rounded-lg" placeholder="비밀번호 입력">
                    </div>
                    <div class="pt-4 flex gap-4">
                        <button type="submit" class="w-full flex justify-center py-3 px-4 text-base font-bold rounded-lg text-white bg-slate-800 hover:bg-slate-900">로그인</button>
                        <button type="button" onclick="showPage('login-page')" class="w-full text-center py-3 px-4 text-base font-bold rounded-lg text-slate-800 bg-slate-200 hover:bg-slate-300">취소</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- 회원가입 페이지 -->
    <div id="register-page" class="hidden">
        <div class="flex items-center justify-center min-h-screen p-4">
            <div class="w-full max-w-2xl p-8 md:p-12 space-y-8 bg-white rounded-2xl shadow-xl">
                <header class="text-center"><h1 class="text-3xl font-bold text-slate-800">회원가입</h1></header>
                <form id="register-form" class="mt-8 space-y-8">
                    <fieldset>
                        <legend class="text-lg font-semibold text-slate-800 mb-4">가입 구분</legend>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div>
                                <input type="radio" name="role" value="TMer" id="tmer" class="sr-only" checked>
                                <label for="tmer" class="role-label cursor-pointer border-2 rounded-lg p-6 flex justify-center items-center transition font-bold">TMer</label>
                            </div>
                            <div>
                                <input type="radio" name="role" value="전문위원" id="specialist" class="sr-only">
                                <label for="specialist" class="role-label cursor-pointer border-2 rounded-lg p-6 flex justify-center items-center transition font-bold">전문위원</label>
                            </div>
                        </div>
                    </fieldset>
                    <div class="space-y-6">
                        <div>
                            <label for="register-name" class="text-sm font-semibold text-slate-700">성명</label>
                            <input id="register-name" name="name" type="text" required class="mt-1 block w-full px-4 py-3 bg-slate-50 border rounded-lg" placeholder="예: 홍길동">
                            <p class="mt-2 text-xs text-slate-500">로그인 시 아이디로 사용될 성명을 입력해주세요. (공백 없이)</p>
                        </div>
                        <div class="hidden" id="company-field">
                            <label for="register-company" class="text-sm font-semibold text-slate-700">소속사</label>
                            <input id="register-company" name="company" type="text" class="mt-1 block w-full px-4 py-3 bg-slate-50 border rounded-lg" placeholder="예: KFPC">
                            <p class="mt-2 text-xs text-slate-500">소속사를 입력해주세요. (TMer는 자동 입력됩니다)</p>
                        </div>
                        <div>
                            <label for="register-phone" class="text-sm font-semibold text-slate-700">전화번호</label>
                            <input id="register-phone" name="phone" type="tel" required class="mt-1 block w-full px-4 py-3 bg-slate-50 border rounded-lg" placeholder="예: 01012345678">
                            <p class="mt-2 text-xs text-slate-500">'-' 기호 없이 숫자만 입력해주세요. 로그인 시 비밀번호로 사용됩니다.</p>
                        </div>
                    </div>
                    <div class="pt-4 flex gap-4">
                        <button type="submit" class="w-full py-4 text-lg font-bold rounded-lg text-slate-800 bg-amber-400 hover:bg-amber-500">회원가입</button>
                        <button type="button" onclick="showPage('login-page')" class="w-full py-4 text-lg font-bold rounded-lg text-slate-800 bg-slate-200 hover:bg-slate-300">취소</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- 관리자 페이지 -->
    <div id="admin-page" class="hidden">
        <div class="full-width-container">
            <header class="mb-4 flex flex-wrap justify-between items-center gap-4">
                <div><h1 class="text-2xl md:text-3xl font-bold text-slate-800">관리자 페이지</h1></div>
                <div class="flex gap-2">
                    <button onclick="showPage('TM-DB-Table')" class="py-2 px-4 text-sm font-semibold rounded-lg text-slate-700 bg-slate-200 hover:bg-slate-300 transition">DB 현황</button>
                    <button onclick="logout()" class="py-2 px-4 text-sm font-semibold rounded-lg text-red-600 bg-red-100 hover:bg-red-200 transition">로그아웃</button>
                </div>
            </header>
            <div class="bg-white rounded-xl shadow-lg mb-4">
                <div class="p-4 border-b"><h2 class="text-lg font-semibold text-slate-800">관리자 정보 변경</h2></div>
                <form id="admin-credential-form" class="p-4">
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4 items-end">
                        <div>
                            <label for="new-admin-id" class="text-sm font-semibold text-slate-700">새로운 아이디</label>
                            <input id="new-admin-id" type="text" required class="mt-1 block w-full px-3 py-2 bg-slate-50 border rounded-md">
                        </div>
                        <div>
                            <label for="new-admin-pw" class="text-sm font-semibold text-slate-700">새로운 비밀번호</label>
                            <input id="new-admin-pw" type="password" required class="mt-1 block w-full px-3 py-2 bg-slate-50 border rounded-md">
                        </div>
                        <div><button type="submit" class="w-full py-2 px-4 font-bold rounded-lg text-white bg-slate-800 hover:bg-slate-900">저장</button></div>
                    </div>
                </form>
            </div>
            <div class="bg-white rounded-xl shadow-lg overflow-hidden">
                <div class="p-4 border-b"><h2 class="text-lg font-semibold text-slate-800">회원 정보 현황</h2></div>
                <div class="w-full overflow-x-auto">
                    <table class="w-full text-sm text-left text-slate-600">
                        <thead class="text-xs text-slate-700 uppercase bg-slate-100">
                            <tr>
                                <th class="px-4 py-3">구분</th>
                                <th class="px-4 py-3">성명</th>
                                <th class="px-4 py-3">전화번호</th>
                                <th class="px-4 py-3">소속사</th>
                                <th class="px-4 py-3">지역</th>
                                <th class="px-4 py-3">제공빈도</th>
                                <th class="px-4 py-3">멤버십</th>
                                <th class="px-4 py-3 text-center">관리</th>
                            </tr>
                        </thead>
                        <tbody id="admin-table-body"></tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
    
    <!-- DB 테이블 페이지 -->
    <div id="TM-DB-Table" class="hidden">
         <div class="full-width-container">
            <header class="mb-4 flex flex-wrap justify-between items-center gap-4">
                <div><h1 class="text-2xl md:text-3xl font-bold text-slate-800">연구소 DB 현황</h1><p id="welcome-user" class="mt-1 text-sm text-slate-500"></p></div>
                <div class="flex gap-2 items-center">
                    <button id="admin-page-button" class="hidden py-2 px-4 text-sm font-semibold rounded-lg text-slate-700 bg-slate-200 hover:bg-slate-300 transition" onclick="showPage('admin-page')">관리자</button>
                    <button onclick="logout()" class="py-2 px-4 text-sm font-semibold rounded-lg text-red-600 bg-red-100 hover:bg-red-200 transition">로그아웃</button>
                </div>
            </header>
            <div class="bg-white rounded-xl shadow-lg overflow-hidden">
                <div class="p-3 flex flex-wrap gap-2 justify-between items-center border-b">
                    <div class="flex items-center gap-2">
                        <h2 class="text-lg font-semibold text-slate-800">기업 리스트</h2>
                        <span id="data-count-display" class="text-sm text-slate-500"></span>
                    </div>
                    <div id="filter-container" class="flex items-center gap-2">
                        <select id="search-column-select" class="border rounded-md p-2 text-sm bg-white">
                            <option value="기업명">기업명</option>
                            <option value="담당 전문위원">담당 전문위원</option>
                        </select>
                        <input type="text" id="search-input" class="w-40 md:w-56 border rounded-md p-2 text-sm" placeholder="검색어 입력" onkeydown="if(event.key==='Enter') searchCompany();">
                        <button onclick="searchCompany()" class="py-2 px-3 text-sm font-bold rounded-lg text-white bg-slate-700 hover:bg-slate-800">검색</button>
                        <button onclick="resetSearch()" class="py-2 px-3 text-sm font-semibold rounded-lg text-slate-700 bg-slate-200 hover:bg-slate-300">초기화</button>
                    </div>
                </div>
                <div class="w-full overflow-x-auto">
                    <table class="w-full text-sm text-left text-slate-600">
                        <thead class="text-xs text-slate-700 uppercase bg-slate-100">
                            <tr class="border-b-2">
                                <th colspan="11" class="px-4 py-2 font-bold text-center bg-blue-100 text-blue-800">기업 기본정보</th>
                                <th colspan="7" class="px-4 py-2 font-bold text-center bg-green-100 text-green-800">전문위원 입력</th>
                                <th colspan="1" class="px-4 py-2 font-bold text-center bg-amber-100 text-amber-800">본사</th>
                            </tr>
                            <tr class="border-b">
                                <!-- A~K열: 기업 기본정보 -->
                                <th class="px-3 py-2 min-w-[50px]">No</th>
                                <th class="px-3 py-2 min-w-[150px]">기업명</th>
                                <th class="px-3 py-2 min-w-[100px]">업종</th>
                                <th class="px-3 py-2 min-w-[80px]">기업규모</th>
                                <th class="px-3 py-2 min-w-[200px]">회사주소</th>
                                <th class="px-3 py-2 min-w-[200px]">연구소주소</th>
                                <th class="px-3 py-2 min-w-[80px]">구분</th>
                                <th class="px-3 py-2 min-w-[120px]">회사Tel</th>
                                <th class="px-3 py-2 min-w-[120px]">회사Fax</th>
                                <th class="px-3 py-2 min-w-[80px]">대표자명</th>
                                <th class="px-3 py-2 min-w-[100px]">담당전문위원</th>
                                <!-- X~AC열: 전문위원 입력항목 -->
                                <th class="px-3 py-2 min-w-[90px]">콜일자</th>
                                <th class="px-3 py-2 min-w-[80px]">통화대상자</th>
                                <th class="px-3 py-2 min-w-[70px]">직함</th>
                                <th class="px-3 py-2 min-w-[200px]">통화내용</th>
                                <th class="px-3 py-2 min-w-[100px]">본사상담요청</th>
                                <th class="px-3 py-2 min-w-[100px]">홈피안내일</th>
                                <th class="px-3 py-2 min-w-[150px]">홈페이지url</th>
                                <!-- AD열: 본사 입력항목 -->
                                <th class="px-3 py-2 min-w-[200px]">본사메모</th>
                            </tr>
                        </thead>
                        <tbody id="db-table-body"></tbody>
                    </table>
                </div>
                <div id="pagination-controls" class="p-3 flex justify-center items-center gap-2 border-t">
                    <div id="page-buttons-container" class="flex items-center gap-1"></div>
                    <div id="page-jump-container" class="flex items-center gap-2 ml-4">
                        <input type="number" id="page-jump-input" class="w-16 border rounded-md p-2 text-sm" placeholder="페이지" onkeydown="if(event.key==='Enter') jumpToPage();">
                        <button onclick="jumpToPage()" class="px-3 py-2 rounded-md text-sm font-medium bg-slate-600 text-white hover:bg-slate-700">이동</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- 상세 정보 모달 -->
    <div id="edit-modal" class="hidden fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50 p-4">
        <div class="w-full max-w-5xl bg-white rounded-2xl shadow-xl flex flex-col max-h-[90vh]">
            <header class="p-6 border-b flex justify-between items-center">
                <h2 id="modal-title" class="text-2xl font-bold text-slate-800">상세 정보 입력</h2>
                <button onclick="closeEditModal()" class="text-gray-400 hover:text-gray-600 text-3xl">&times;</button>
            </header>

            <div id="modal-warning" class="hidden p-4 text-sm text-amber-800 bg-amber-100 text-center font-semibold"></div>

            <div class="p-8 modal-body overflow-y-auto">
                <form id="edit-form" onkeydown="handleEnterKey(event)">
                    <input name="originalIndex" type="hidden">
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-x-8 gap-y-6">
                        
                        <!-- 기업 기본정보 (A~K열) -->
                        <fieldset id="company-info-fieldset" class="lg:col-span-3 grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-x-8 gap-y-6">
                            <legend class="lg:col-span-3 font-bold text-lg text-blue-800 border-b-2 border-blue-200 pb-2 mb-4">기업 기본정보</legend>
                            <input name="No" type="hidden">
                            <div><label class="font-semibold">기업명</label><input name="기업명" type="text" class="w-full p-2 mt-1 border rounded" readonly></div>
                            <div><label class="font-semibold">업종</label><input name="업종" type="text" class="w-full p-2 mt-1 border rounded" readonly></div>
                            <div><label class="font-semibold">기업규모</label><input name="기업규모" type="text" class="w-full p-2 mt-1 border rounded" readonly></div>
                            <div class="lg:col-span-3"><label class="font-semibold">회사주소</label><input name="회사주소" type="text" class="w-full p-2 mt-1 border rounded" readonly></div>
                            <div class="lg:col-span-3"><label class="font-semibold">연구소주소</label><input name="연구소주소" type="text" class="w-full p-2 mt-1 border rounded" readonly></div>
                            <div><label class="font-semibold">구분</label><input name="구분" type="text" class="w-full p-2 mt-1 border rounded" readonly></div>
                            <div><label class="font-semibold">회사Tel</label><input name="회사Tel" type="text" class="w-full p-2 mt-1 border rounded" readonly></div>
                            <div><label class="font-semibold">회사Fax</label><input name="회사Fax" type="text" class="w-full p-2 mt-1 border rounded" readonly></div>
                            <div><label class="font-semibold">대표자명</label><input name="대표자명" type="text" class="w-full p-2 mt-1 border rounded" readonly></div>
                            <div><label class="font-semibold">담당 전문위원</label><input name="담당 전문위원" type="text" class="w-full p-2 mt-1 border rounded bg-gray-100" readonly></div>
                        </fieldset>
                        
                        <!-- 전문위원 입력항목 (X~AC열) -->
                        <fieldset id="specialist-fieldset" class="lg:col-span-3 grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-x-8 gap-y-6">
                            <legend class="lg:col-span-3 font-bold text-lg text-green-800 border-b-2 border-green-200 pb-2 mb-4 mt-6">전문위원 입력항목</legend>
                            <div>
                                <label class="font-semibold flex items-center">콜일자</label>
                                <input name="콜일자" type="text" class="w-full p-2 mt-1 border rounded" placeholder="예: 2025-01-10">
                            </div>
                            <div>
                                <label class="font-semibold flex items-center">통화대상자</label>
                                <input name="통화대상자" type="text" class="w-full p-2 mt-1 border rounded">
                            </div>
                            <div>
                                <label class="font-semibold flex items-center">직함</label>
                                <input name="직함" type="text" list="job-title-list" class="w-full p-2 mt-1 border rounded" placeholder="선택 또는 직접입력">
                                <datalist id="job-title-list">
                                    <option value="대표">
                                    <option value="연구소장">
                                    <option value="책임자">
                                    <option value="부장">
                                    <option value="기타">
                                </datalist>
                            </div>
                            <div class="lg:col-span-3">
                                <label class="font-semibold flex items-center">통화내용_전문위원</label>
                                <textarea name="통화내용_전문위원" rows="3" class="w-full p-2 mt-1 border rounded"></textarea>
                            </div>
                            <div>
                                <label class="font-semibold flex items-center">본사상담요청</label>
                                <select name="본사상담요청" class="w-full p-2 mt-1 border rounded">
                                    <option value="">선택</option>
                                    <option value="요청(관심도_높음)">요청(관심도_높음)</option>
                                    <option value="요청(관심도_보통)">요청(관심도_보통)</option>
                                    <option value="요청(관심도_낮음)">요청(관심도_낮음)</option>
                                    <option value="대상아님">대상아님</option>
                                    <option value="추후진행">추후진행</option>
                                </select>
                            </div>
                            <div>
                                <label class="font-semibold flex items-center">홈페이지안내일자</label>
                                <input name="홈페이지안내일자" type="text" class="w-full p-2 mt-1 border rounded" placeholder="예: 2025-01-10">
                            </div>
                            <div>
                                <label class="font-semibold flex items-center">홈페이지url <span class="text-xs text-slate-400 ml-2">(본사입력)</span></label>
                                <input name="홈페이지url" type="text" class="w-full p-2 mt-1 border rounded bg-gray-100" readonly>
                            </div>
                        </fieldset>
                        
                        <!-- 본사 입력항목 (AD열) -->
                        <fieldset id="hq-fieldset" class="lg:col-span-3 grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-x-8 gap-y-6">
                            <legend class="lg:col-span-3 font-bold text-lg text-amber-800 border-b-2 border-amber-200 pb-2 mb-4 mt-6">본사 입력항목</legend>
                            <div class="lg:col-span-3">
                                <label class="font-semibold flex items-center">본사담당자메모<span class="tooltip-icon" onmouseenter="showTooltip(this, '본사 담당자가 메모를 입력합니다.')" onmouseleave="hideTooltip()">ⓘ</span></label>
                                <textarea name="본사담당자메모" rows="3" class="w-full p-2 mt-1 border rounded"></textarea>
                            </div>
                        </fieldset>
                        
                    </div>
                </form>
            </div>
            <footer class="p-6 border-t flex justify-between items-center gap-4">
                <button id="delete-button" onclick="deleteCompany()" class="hidden py-3 px-6 font-bold rounded-lg text-red-600 bg-red-100 hover:bg-red-200 transition">삭제</button>
                <div class="flex gap-4 ml-auto">
                    <button type="button" onclick="closeEditModal()" class="py-3 px-8 font-bold rounded-lg text-slate-700 bg-slate-200 hover:bg-slate-300">취소</button>
                    <button type="button" onclick="saveModalData()" class="py-3 px-8 font-bold rounded-lg text-white bg-slate-800 hover:bg-slate-900">저장</button>
                </div>
            </footer>
        </div>
    </div>

<script>
    // === 전역 변수 ===
    const GAS_API_URL = 'https://script.google.com/macros/s/AKfycbxT_jFERIyCqadOsT1FQxNu-L-tclH7FT87czgrtZey_PzTVp0S2HRzoJ5F-e1iS8ow/exec';
    let loggedInUser = null;
    let allUsers = [];
    let allCompanies = [];
    let cachedAllCompanies = []; // 전체 데이터 캐시
    let totalCompanies = 0;
    let currentPage = 1;
    const companiesLimit = 10; // 한 화면에 10행 표시
    let currentFilter = {};

    // === API 호출 ===
    function showLoading() { document.getElementById('loading-overlay').classList.remove('hidden'); }
    function hideLoading() { document.getElementById('loading-overlay').classList.add('hidden'); }

    async function callAPI(action, sheet, data = {}) {
        showLoading();
        try {
            const response = await fetch(GAS_API_URL, {
                method: 'POST',
                headers: { 'Content-Type': 'text/plain;charset=utf-8' },
                body: JSON.stringify({ action, sheet, ...data })
            });
            const result = await response.json();
            if (result.error) {
                console.error('API Error:', result.error);
                alert('오류 발생: ' + result.error);
                return null;
            }
            return result;
        } catch (error) {
            console.error('Fetch Error:', error);
            alert('서버와 통신 중 오류가 발생했습니다.');
            return null;
        } finally {
            hideLoading();
        }
    }

    // === 페이지 이동 ===
    function showPage(pageId) {
        document.querySelectorAll('body > div[id$="-page"], body > div[id="TM-DB-Table"], body > div[id="admin-page"]').forEach(p => p.classList.add('hidden'));
        document.getElementById(pageId)?.classList.remove('hidden');
        if (pageId === 'TM-DB-Table' && loggedInUser) loadInitialData();
        if (pageId === 'admin-page' && loggedInUser) renderAdminTable();
    }
    window.showPage = showPage;

    function logout() {
        loggedInUser = null;
        sessionStorage.removeItem('loggedInUser');
        allUsers = [];
        allCompanies = [];
        showPage('login-page');
    }
    window.logout = logout;

    // === 로그인 처리 ===
    document.getElementById('login-form').addEventListener('submit', async (e) => {
        e.preventDefault();
        const username = document.getElementById('username').value.trim();
        const password = document.getElementById('password').value.trim();
        const users = await callAPI('readAll', 'Users');
        if (users) {
            allUsers = users;
            const user = users.find(u => u.name === username && u.phone === password);
            if (user) {
                loggedInUser = user;
                sessionStorage.setItem('loggedInUser', JSON.stringify(user));
                showPage('TM-DB-Table');
            } else {
                alert('아이디 또는 비밀번호가 일치하지 않습니다.');
            }
        }
    });

    document.getElementById('admin-login-form').addEventListener('submit', async (e) => {
        e.preventDefault();
        const adminId = document.getElementById('admin-id').value.trim();
        const adminPw = document.getElementById('admin-pw').value.trim();
        const adminData = await callAPI('readAll', 'Admin');
        if (adminData && adminData.length > 0) {
            const admin = adminData[0];
            if (admin.id === adminId && admin.pw === adminPw) {
                loggedInUser = { name: '관리자', role: 'admin' };
                sessionStorage.setItem('loggedInUser', JSON.stringify(loggedInUser));
                showPage('admin-page');
            } else {
                alert('관리자 정보가 일치하지 않습니다.');
            }
        }
    });

    // === 회원가입 ===
    document.getElementById('register-form').addEventListener('submit', async (e) => {
        e.preventDefault();
        const form = e.target;
        const role = form.querySelector('input[name="role"]:checked').value;
        const newUser = {
            role: role,
            name: form.querySelector('#register-name').value.trim(),
            phone: form.querySelector('#register-phone').value.trim(),
            company: role === 'TMer' ? 'KFPC' : form.querySelector('#register-company').value.trim(),
            region: '',
            frequency: '',
            Membership: ''
        };
        const existingUsers = await callAPI('readAll', 'Users');
        if (existingUsers && existingUsers.some(u => u.name === newUser.name)) {
            alert('이미 존재하는 이름입니다. 다른 이름을 사용해주세요.');
            return;
        }
        const result = await callAPI('write', 'Users', { data: newUser });
        if (result && result.success) {
            alert('회원가입이 완료되었습니다! 로그인해주세요.');
            showPage('login-page');
        }
    });

    // === 관리자 정보 변경 ===
    document.getElementById('admin-credential-form').addEventListener('submit', async (e) => {
        e.preventDefault();
        const newId = document.getElementById('new-admin-id').value.trim();
        const newPw = document.getElementById('new-admin-pw').value.trim();
        if (newId && newPw) {
            const result = await callAPI('update', 'Admin', { data: { id: newId, pw: newPw }, rowIndex: 2 });
            alert('관리자 정보가 성공적으로 변경되었습니다.');
        } else {
            alert('새로운 아이디와 비밀번호를 모두 입력해주세요.');
        }
    });

    // === 관리자 테이블 렌더링 ===
    async function renderAdminTable() {
        await loadUsers();
        const tableBody = document.getElementById('admin-table-body');
        tableBody.innerHTML = '';
        if (allUsers.length === 0) {
            tableBody.innerHTML = `<tr><td colspan="8" class="text-center py-16 text-slate-500">등록된 회원이 없습니다.</td></tr>`;
            return;
        }
        allUsers.forEach((member, index) => {
            const row = document.createElement('tr');
            row.className = 'bg-white border-b';
            row.id = `user-row-${index}`;
            row.innerHTML = getUserRowHtml(member, index);
            tableBody.appendChild(row);
        });
    }

    function getUserRowHtml(member, index) {
        return `
            <td class="px-4 py-3 font-semibold">${member.role}</td>
            <td class="px-4 py-3">${member.name}</td>
            <td class="px-4 py-3">${member.phone}</td>
            <td class="px-4 py-3">${member.company || ''}</td>
            <td class="px-4 py-3">${member.region || ''}</td>
            <td class="px-4 py-3">${member.frequency || ''}</td>
            <td class="px-4 py-3">${member.Membership || ''}</td>
            <td class="px-4 py-3 text-center">
                <div class="flex justify-center items-center gap-2">
                    <button onclick="editUser(${index})" class="font-semibold text-blue-600 hover:text-blue-800">수정</button>
                    <button onclick="deleteUser(${index})" class="font-semibold text-red-500 hover:text-red-700">삭제</button>
                </div>
            </td>
        `;
    }

    function getEditUserRowHtml(member, index) {
        return `
            <td class="px-4 py-2">
                <select name="role" class="w-full p-1 border rounded bg-slate-50 text-sm">
                    <option value="TMer" ${member.role === 'TMer' ? 'selected' : ''}>TMer</option>
                    <option value="전문위원" ${member.role === '전문위원' ? 'selected' : ''}>전문위원</option>
                </select>
            </td>
            <td class="px-4 py-2"><input name="name" type="text" value="${member.name}" class="w-full p-1 border rounded bg-gray-200 text-sm" readonly></td>
            <td class="px-4 py-2"><input name="phone" type="text" value="${member.phone}" class="w-full p-1 border rounded bg-slate-50 text-sm"></td>
            <td class="px-4 py-2"><input name="company" type="text" value="${member.company || ''}" class="w-full p-1 border rounded bg-slate-50 text-sm"></td>
            <td class="px-4 py-2"><input name="region" type="text" value="${member.region || ''}" class="w-full p-1 border rounded bg-slate-50 text-sm" placeholder="서울, 경기"></td>
            <td class="px-4 py-2"><input name="frequency" type="text" value="${member.frequency || ''}" class="w-full p-1 border rounded bg-slate-50 text-sm" placeholder="주1회"></td>
            <td class="px-4 py-2"><input name="Membership" type="text" value="${member.Membership || ''}" class="w-full p-1 border rounded bg-slate-50 text-sm" placeholder="Branch"></td>
            <td class="px-4 py-2 text-center">
                <div class="flex justify-center items-center gap-2">
                    <button onclick="saveUser(${index})" class="font-semibold text-green-600 hover:text-green-800">저장</button>
                    <button onclick="renderAdminTable()" class="font-semibold text-gray-600 hover:text-gray-800">취소</button>
                </div>
            </td>
        `;
    }

    function editUser(index) {
        const row = document.getElementById(`user-row-${index}`);
        row.innerHTML = getEditUserRowHtml(allUsers[index], index);
    }
    window.editUser = editUser;

    async function saveUser(index) {
        const row = document.getElementById(`user-row-${index}`);
        const originalUser = allUsers[index];
        const updatedUserData = {
            role: row.querySelector('[name="role"]').value,
            name: row.querySelector('[name="name"]').value,
            phone: row.querySelector('[name="phone"]').value,
            company: row.querySelector('[name="company"]').value,
            region: row.querySelector('[name="region"]').value,
            frequency: row.querySelector('[name="frequency"]').value,
            Membership: row.querySelector('[name="Membership"]').value
        };
        const result = await callAPI('update', 'Users', { data: updatedUserData, rowIndex: originalUser.originalIndex });
        if (result && result.success) {
            alert('회원 정보가 수정되었습니다.');
            allUsers = [];
            await renderAdminTable();
        }
    }
    window.saveUser = saveUser;

    async function deleteUser(index) {
        const userToDelete = allUsers[index];
        if (confirm(`'${userToDelete.name}' 회원을 정말로 삭제하시겠습니까?`)) {
            const result = await callAPI('delete', 'Users', { rowIndex: userToDelete.originalIndex });
            if (result && result.success) {
                alert('삭제되었습니다.');
                allUsers = [];
                await renderAdminTable();
            }
        }
    }
    window.deleteUser = deleteUser;

    // === 데이터 로딩 ===
    async function loadUsers() {
        if (allUsers.length > 0) return;
        const users = await callAPI('readAll', 'Users');
        if (users) allUsers = users;
    }

    async function loadInitialData(page = 1, filter = currentFilter) {
        currentPage = page;
        currentFilter = filter;
        if (allUsers.length === 0) await loadUsers();

        let effectiveFilter = { ...filter };
        
        // 전문위원 로그인 시: W열(담당 전문위원)이 본인 이름인 행만 필터링
        if (loggedInUser.role === '전문위원') {
            effectiveFilter['담당 전문위원'] = loggedInUser.name;
        }

        const result = await callAPI('read', 'Companies', { page, limit: companiesLimit, filter: effectiveFilter });

        if (result) {
            allCompanies = result.data;
            totalCompanies = result.total;
            
            // 캐시 업데이트 (현재 페이지 데이터 추가)
            result.data.forEach(company => {
                const existIdx = cachedAllCompanies.findIndex(c => c.originalIndex === company.originalIndex);
                if (existIdx >= 0) {
                    cachedAllCompanies[existIdx] = company;
                } else {
                    cachedAllCompanies.push(company);
                }
            });
            
            document.getElementById('data-count-display').textContent = `(총 ${totalCompanies}개)`;
            renderDbTable();
            renderPagination();
            document.getElementById('welcome-user').textContent = `${loggedInUser.name}(${loggedInUser.role})님 환영합니다`;
            document.getElementById('admin-page-button').classList.toggle('hidden', loggedInUser.role !== 'admin');
        }
    }

    // === DB 테이블 렌더링 ===
    function renderDbTable() {
        const tableBody = document.getElementById('db-table-body');
        tableBody.innerHTML = '';

        if (allCompanies.length === 0) {
            tableBody.innerHTML = `<tr><td colspan="19" class="text-center py-10 text-slate-500">표시할 기업 정보가 없습니다.</td></tr>`;
            return;
        }

        // 표시할 컬럼
        const headers = [
            '기업명', '업종', '기업규모', '회사주소', '연구소주소', '구분', '회사Tel', '회사Fax', '대표자명', '담당 전문위원',
            '콜일자', '통화대상자', '직함', '통화내용_전문위원', '본사상담요청', '홈페이지안내일자', '홈페이지url',
            '본사담당자메모'
        ];

        allCompanies.forEach((company, index) => {
            const row = document.createElement('tr');
            row.className = 'cursor-pointer hover:bg-amber-50 border-b';
            row.onclick = () => openEditModal(company.originalIndex);

            let rowHtml = `<td class="px-3 py-2 whitespace-nowrap">${(currentPage - 1) * companiesLimit + index + 1}</td>`;
            
            headers.forEach(header => {
                let cellValue = company[header] || '';
                // 긴 텍스트는 줄임
                if (typeof cellValue === 'string' && cellValue.length > 30) {
                    cellValue = cellValue.substring(0, 30) + '...';
                }
                rowHtml += `<td class="px-3 py-2 whitespace-nowrap">${cellValue}</td>`;
            });
            
            row.innerHTML = rowHtml;
            tableBody.appendChild(row);
        });
    }

    // === 페이지네이션 ===
    function renderPagination() {
        const totalPages = Math.ceil(totalCompanies / companiesLimit);
        const controls = document.getElementById('page-buttons-container');
        controls.innerHTML = '';

        if (totalPages <= 1) return;

        const createButton = (text, page, isDisabled = false, isCurrent = false) => {
            const button = document.createElement('button');
            button.innerHTML = text;
            button.disabled = isDisabled;
            let styles = 'px-3 py-1 rounded text-sm font-medium transition-colors ';
            if (isCurrent) styles += 'bg-slate-800 text-white cursor-default';
            else if (isDisabled) styles += 'bg-slate-200 text-slate-400 cursor-not-allowed';
            else styles += 'bg-white text-slate-700 hover:bg-slate-100 border';
            button.className = styles;
            if (!isDisabled && !isCurrent) button.onclick = () => loadInitialData(page);
            return button;
        };

        controls.appendChild(createButton('◀', currentPage - 1, currentPage === 1));

        let startPage, endPage;
        if (totalPages <= 7) { startPage = 1; endPage = totalPages; }
        else {
            if (currentPage <= 4) { startPage = 1; endPage = 7; }
            else if (currentPage + 3 >= totalPages) { startPage = totalPages - 6; endPage = totalPages; }
            else { startPage = currentPage - 3; endPage = currentPage + 3; }
        }

        if (startPage > 1) {
            controls.appendChild(createButton(1, 1));
            if (startPage > 2) controls.insertAdjacentHTML('beforeend', `<span class="px-2">...</span>`);
        }
        for (let i = startPage; i <= endPage; i++) {
            controls.appendChild(createButton(i, i, false, i === currentPage));
        }
        if (endPage < totalPages) {
            if (endPage < totalPages - 1) controls.insertAdjacentHTML('beforeend', `<span class="px-2">...</span>`);
            controls.appendChild(createButton(totalPages, totalPages));
        }

        controls.appendChild(createButton('▶', currentPage + 1, currentPage === totalPages));
    }
    window.renderPagination = renderPagination;

    function jumpToPage() {
        const totalPages = Math.ceil(totalCompanies / companiesLimit);
        const pageInput = document.getElementById('page-jump-input');
        const page = parseInt(pageInput.value);
        if (isNaN(page) || page < 1 || page > totalPages) {
            alert(`1에서 ${totalPages} 사이의 페이지 번호를 입력해주세요.`);
            pageInput.value = '';
            return;
        }
        loadInitialData(page);
    }
    window.jumpToPage = jumpToPage;

    function searchCompany() {
        const column = document.getElementById('search-column-select').value;
        const searchTerm = document.getElementById('search-input').value;
        currentFilter = { [column]: searchTerm };
        loadInitialData(1, currentFilter);
    }
    window.searchCompany = searchCompany;

    function resetSearch() {
        document.getElementById('search-input').value = '';
        currentFilter = {};
        loadInitialData(1, currentFilter);
    }
    window.resetSearch = resetSearch;

    // === 모달 로직 ===
    async function openEditModal(originalIndex) {
        // 먼저 현재 페이지 데이터에서 찾기
        let company = allCompanies.find(c => c.originalIndex === originalIndex);
        
        // 없으면 캐시에서 찾기
        if (!company && cachedAllCompanies.length > 0) {
            company = cachedAllCompanies.find(c => c.originalIndex === originalIndex);
        }
        
        // 그래도 없으면 API 호출
        if (!company) {
            showLoading();
            const fullList = await callAPI('readAll', 'Companies');
            hideLoading();
            if (fullList) {
                cachedAllCompanies = fullList;
                company = fullList.find(c => c.originalIndex === originalIndex);
            }
        }
        
        if (company) {
            const form = document.getElementById('edit-form');
            form.reset();
            
            for (const key in company) {
                if (form.elements[key]) {
                    form.elements[key].value = company[key] || '';
                }
            }
            
            form.elements['originalIndex'].value = originalIndex;
            document.getElementById('modal-title').textContent = `[${company['기업명'] || '미입력'}] 상세 정보`;
            document.getElementById('delete-button').classList.add('hidden');
            
            applyRolePermissions();
            document.getElementById('edit-modal').classList.remove('hidden');
        } else {
            alert('해당 기업 정보를 찾을 수 없습니다.');
        }
    }
    window.openEditModal = openEditModal;

    function openNewCompanyModal() {
        const form = document.getElementById('edit-form');
        form.reset();
        form.elements['originalIndex'].value = '';
        document.getElementById('modal-title').textContent = '신규 기업 등록';
        document.getElementById('delete-button').classList.add('hidden');
        applyRolePermissions();
        document.getElementById('edit-modal').classList.remove('hidden');
    }
    window.openNewCompanyModal = openNewCompanyModal;

    function closeEditModal() {
        document.getElementById('edit-modal').classList.add('hidden');
    }
    window.closeEditModal = closeEditModal;

    async function saveModalData() {
        const form = document.getElementById('edit-form');
        const formData = new FormData(form);
        const newData = {};
        for (let [key, value] of formData.entries()) newData[key] = value;
        
        const originalIndexValue = newData.originalIndex;
        const originalIndex = (originalIndexValue !== '' && !isNaN(parseInt(originalIndexValue))) ? parseInt(originalIndexValue) : null;
        delete newData.originalIndex;

        const action = (originalIndex !== null) ? 'update' : 'write';
        const payload = { data: newData, rowIndex: originalIndex };

        const result = await callAPI(action, 'Companies', payload);

        if (result && result.success) {
            alert('저장되었습니다!');
            closeEditModal();
            cachedAllCompanies = []; // 캐시 초기화
            await loadInitialData(action === 'update' ? currentPage : 1);
        }
    }
    window.saveModalData = saveModalData;

    async function deleteCompany() {
        const originalIndex = document.querySelector('#edit-form input[name="originalIndex"]').value;
        if (originalIndex === '' || originalIndex === null) return;
        if (confirm('정말로 이 기업 정보를 삭제하시겠습니까?')) {
            const result = await callAPI('delete', 'Companies', { rowIndex: parseInt(originalIndex) });
            if (result && result.success) {
                alert('삭제되었습니다.');
                closeEditModal();
                await loadInitialData(1);
            }
        }
    }
    window.deleteCompany = deleteCompany;

    // === 권한 설정 ===
    function applyRolePermissions() {
        const form = document.getElementById('edit-form');
        
        // 기본정보는 항상 읽기 전용
        form.querySelector('#company-info-fieldset').querySelectorAll('input, select, textarea').forEach(el => {
            el.readOnly = true;
            el.disabled = false;
        });
        
        if (loggedInUser.role === 'admin') {
            // 관리자: 모든 필드 편집 가능
            form.querySelectorAll('fieldset').forEach(fs => {
                fs.querySelectorAll('input, select, textarea').forEach(el => {
                    el.readOnly = false;
                    el.disabled = false;
                });
            });
        } else if (loggedInUser.role === '전문위원') {
            // 전문위원: 기본정보 읽기전용, 전문위원 입력항목만 편집 가능, 본사 입력항목 비활성화
            form.querySelector('#specialist-fieldset').querySelectorAll('input, select, textarea').forEach(el => {
                el.readOnly = false;
                el.disabled = false;
            });
            form.querySelector('#hq-fieldset').disabled = true;
        }
    }

    // === UI 헬퍼 함수 ===
    const roleRadios = document.querySelectorAll('#register-form input[name="role"]');
    function updateRoleSelection() {
        const form = document.getElementById('register-form');
        if (!form.querySelector('input[name="role"]:checked')) return;
        const selectedRole = form.querySelector('input[name="role"]:checked').value;
        document.querySelectorAll('#register-form .role-label').forEach(label => 
            label.classList.toggle('selected', label.htmlFor === (selectedRole === '전문위원' ? 'specialist' : 'tmer'))
        );
        const companyField = document.getElementById('company-field');
        companyField.classList.toggle('hidden', selectedRole !== '전문위원');
        companyField.querySelector('input').required = selectedRole === '전문위원';
    }
    roleRadios.forEach(radio => radio.addEventListener('change', updateRoleSelection));

    function handleEnterKey(event) {
        if (event.key === 'Enter' && event.target.tagName.toLowerCase() !== 'textarea') {
            if (event.target.tagName.toLowerCase() === 'select') return;
            event.preventDefault();
            const form = event.target.form;
            const fields = Array.from(form.querySelectorAll('input:not([readonly]):not([type=hidden]), select, textarea')).filter(el => !el.disabled);
            const currentIndex = fields.indexOf(event.target);
            const nextIndex = currentIndex + 1;
            if (nextIndex < fields.length) fields[nextIndex].focus();
        }
    }
    window.handleEnterKey = handleEnterKey;

    const tooltip = document.getElementById('global-tooltip');
    function showTooltip(iconElement, text) {
        tooltip.innerHTML = text;
        tooltip.style.visibility = 'visible';
        tooltip.style.opacity = '1';
        const rect = iconElement.getBoundingClientRect();
        let top = rect.top - tooltip.offsetHeight - 10;
        if (top < 10) top = rect.bottom + 10;
        let left = rect.left + (rect.width / 2) - (tooltip.offsetWidth / 2);
        if (left < 10) left = 10;
        else if (left + tooltip.offsetWidth > window.innerWidth - 10) left = window.innerWidth - tooltip.offsetWidth - 10;
        tooltip.style.top = `${top}px`;
        tooltip.style.left = `${left}px`;
    }
    window.showTooltip = showTooltip;

    function hideTooltip() {
        tooltip.style.visibility = 'hidden';
        tooltip.style.opacity = '0';
    }
    window.hideTooltip = hideTooltip;

    // === 페이지 첫 로드 ===
    document.addEventListener('DOMContentLoaded', () => {
        const savedUser = sessionStorage.getItem('loggedInUser');
        if (savedUser) {
            loggedInUser = JSON.parse(savedUser);
            if (loggedInUser.role === 'admin') {
                showPage('admin-page');
            } else {
                showPage('TM-DB-Table');
            }
        } else {
            showPage('login-page');
        }
        updateRoleSelection();
    });
</script>
</body>
</html>
