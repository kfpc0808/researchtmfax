<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì—°êµ¬ì†Œ DB Project</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Noto Sans KR', sans-serif; word-break: keep-all; }
        .hidden { display: none; }
        .role-label.selected { background-color: #f59e0b; color: #1e293b; border-color: #d97706; }
        .modal-body::-webkit-scrollbar { width: 8px; height: 8px; }
        .modal-body::-webkit-scrollbar-track { background: #f1f5f9; }
        .modal-body::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 4px; }
        input:disabled, select:disabled, textarea:disabled { background-color: #f1f5f9; cursor: not-allowed; opacity: 0.7; }
        input[readonly] { background-color: #f1f5f9; }
        .loading-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background-color: rgba(255, 255, 255, 0.8); z-index: 1000;
            display: flex; align-items: center; justify-content: center;
        }
        .loader {
            border: 8px solid #f3f3f3; border-top: 8px solid #3498db;
            border-radius: 50%; width: 60px; height: 60px; animation: spin 2s linear infinite;
        }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
        
        .tooltip-icon {
            position: relative; margin-left: 6px; cursor: pointer; color: #94a3b8;
            border: 1px solid #e2e8f0; border-radius: 50%; width: 20px; height: 20px;
            display: inline-flex; justify-content: center; align-items: center;
            font-size: 12px; font-weight: bold; font-style: italic; user-select: none; transition: all 0.2s ease;
        }
        .tooltip-icon:hover { background-color: #1e293b; color: white; border-color: #1e293b; }
        #global-tooltip {
            visibility: hidden; width: 280px; background-color: #1e293b; color: #fff;
            text-align: left; border-radius: 6px; padding: 12px; position: fixed;
            z-index: 1001; opacity: 0; transition: opacity 0.2s; pointer-events: none;
            font-size: 13px; font-weight: 400; line-height: 1.6;
        }
        th, td, button, a { white-space: nowrap; }
        /* ì „ì²´ í™”ë©´ ì‚¬ìš© */
        .full-width-container { width: 100%; padding: 8px; }
        @media (min-width: 768px) { .full-width-container { padding: 16px; } }
    </style>
</head>
<body class="bg-slate-100 pb-20">

    <div id="loading-overlay" class="loading-overlay hidden">
        <div class="loader"></div>
    </div>
    
    <div id="global-tooltip"></div>

    <!-- ë¡œê·¸ì¸ í˜ì´ì§€ -->
    <div id="login-page">
        <div class="flex items-center justify-center min-h-screen">
            <div class="w-full max-w-md p-8 space-y-8 bg-white rounded-2xl shadow-xl">
                <header class="text-center">
                    <h1 class="text-3xl font-bold text-slate-800">ì—°êµ¬ì†Œ DB Project</h1>
                    <p class="mt-2 text-sm text-slate-500">ì œì‘ : (ì£¼)í•œêµ­FPì„¼í„° ë¶€ì„¤ ì¤‘ì†Œê¸°ì—…ê²½ì˜ì—°êµ¬ì†Œ</p>
                </header>
                <form id="login-form" class="mt-8 space-y-6">
                    <div>
                        <label for="username" class="text-sm font-semibold text-slate-700">ì•„ì´ë”” (ì„±ëª…)</label>
                        <input id="username" type="text" required class="mt-2 block w-full px-4 py-3 bg-slate-50 border rounded-lg" placeholder="ê°€ì…í•˜ì‹  ì„±ëª…ì„ ì…ë ¥í•˜ì„¸ìš”">
                    </div>
                    <div>
                        <label for="password" class="text-sm font-semibold text-slate-700">ì „í™”ë²ˆí˜¸ (ë¹„ë°€ë²ˆí˜¸)</label>
                        <input id="password" type="password" required class="mt-2 block w-full px-4 py-3 bg-slate-50 border rounded-lg" placeholder="'-'ë¥¼ ì œì™¸í•œ ì „í™”ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”">
                    </div>
                    <div><button type="submit" class="w-full flex justify-center py-3 px-4 text-base font-bold rounded-lg text-white bg-slate-800 hover:bg-slate-900">ë¡œê·¸ì¸</button></div>
                </form>
                <div class="pt-4 border-t grid grid-cols-2 gap-4">
                    <button type="button" onclick="showFeaturesModal()" class="text-center py-3 px-4 text-sm font-semibold rounded-lg text-white bg-sky-600 hover:bg-sky-700">ê¸°ì—…í™ˆí˜ì´ì§€ ì£¼ìš”ê¸°ëŠ¥</button>
                    <button type="button" onclick="showPriceTableModal()" class="text-center py-3 px-4 text-sm font-semibold rounded-lg text-white bg-teal-600 hover:bg-teal-700">ê¸°ì—…í™ˆí˜ì´ì§€ ê°€ê²©í‘œ</button>
                </div>
                
                <!-- ì£¼ìš”ê¸°ëŠ¥ ëª¨ë‹¬ -->
                <div id="features-modal" class="hidden fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center z-50 p-4">
                    <div class="bg-white rounded-2xl shadow-2xl max-w-2xl w-full max-h-[90vh] overflow-hidden">
                        <!-- í—¤ë” -->
                        <div class="bg-gradient-to-r from-sky-600 via-blue-600 to-indigo-700 text-white px-6 py-5">
                            <h3 class="text-2xl font-bold text-center tracking-tight">ê¸°ì—…í™ˆí˜ì´ì§€ ì‹œìŠ¤í…œ</h3>
                            <p class="text-center text-sky-100 text-sm mt-1">ì£¼ìš”ê¸°ëŠ¥ ì•ˆë‚´</p>
                        </div>
                        
                        <!-- ì»¨í…ì¸  -->
                        <div class="p-6 overflow-y-auto max-h-[60vh] space-y-4">
                            <!-- ê¸°ëŠ¥ 1 -->
                            <div class="bg-gradient-to-br from-slate-50 to-slate-100 rounded-xl p-4 border border-slate-200 hover:shadow-md transition-shadow">
                                <div class="flex items-start gap-3">
                                    <span class="flex-shrink-0 w-8 h-8 bg-sky-600 text-white rounded-lg flex items-center justify-center font-bold text-sm">1</span>
                                    <div>
                                        <h4 class="font-bold text-slate-800">ê¸°ì—… ë§ì¶¤í˜• í™ˆí˜ì´ì§€</h4>
                                        <p class="text-sm text-slate-600 mt-1">â€¢ ëŒ€ì™¸ì‹ ë¢° ë° ë§ˆì¼€íŒ… í™ë³´ìš©ìœ¼ë¡œ ì ì ˆ</p>
                                        <p class="text-sm text-slate-600">â€¢ ê±°ë˜ì²˜/ê³ ê°/ì…ì‚¬ì§€ì›ìì—ê²Œ 'ì •ëˆëœ íšŒì‚¬' ì¸ì‹ ì–´í•„</p>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- ê¸°ëŠ¥ 2 -->
                            <div class="bg-gradient-to-br from-slate-50 to-slate-100 rounded-xl p-4 border border-slate-200 hover:shadow-md transition-shadow">
                                <div class="flex items-start gap-3">
                                    <span class="flex-shrink-0 w-8 h-8 bg-sky-600 text-white rounded-lg flex items-center justify-center font-bold text-sm">2</span>
                                    <div>
                                        <h4 class="font-bold text-slate-800">100% ì»¤ìŠ¤í„°ë§ˆì´ì§• (ë¸Œëœë“œ ê·¸ëŒ€ë¡œ)</h4>
                                        <p class="text-sm text-slate-600 mt-1">â€¢ ë¡œê³ , ì´ë¯¸ì§€, í‘¸í„°, ì¸ì‚¬ë§, ë©”ë‰´ êµ¬ì„± ë“± íšŒì‚¬ ë§ì¶¤ ìˆ˜ì •</p>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- ê¸°ëŠ¥ 3 -->
                            <div class="bg-gradient-to-br from-slate-50 to-slate-100 rounded-xl p-4 border border-slate-200 hover:shadow-md transition-shadow">
                                <div class="flex items-start gap-3">
                                    <span class="flex-shrink-0 w-8 h-8 bg-sky-600 text-white rounded-lg flex items-center justify-center font-bold text-sm">3</span>
                                    <div>
                                        <h4 class="font-bold text-slate-800">ì—°êµ¬ì†Œ ë³´ìœ ì‹œ</h4>
                                        <p class="text-sm text-slate-600 mt-1">â€¢ ì—°êµ¬ë…¸íŠ¸/ê³¼ì œ ê¸°ë¡/ì¦ë¹™ ìë£Œë¥¼ êµ¬ì¡°í™” ì €ì¥</p>
                                        <p class="text-sm text-slate-600">â€¢ ì—° 1íšŒ ì‹¤ì‚¬ëŒ€ì‘ ì‹œ ìë£Œ ëˆ„ë½ë°©ì§€ ë° ì°¾ëŠ” ì‹œê°„ ê°ì†Œ</p>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- ê¸°ëŠ¥ 4 -->
                            <div class="bg-gradient-to-br from-amber-50 to-orange-50 rounded-xl p-4 border border-amber-200 hover:shadow-md transition-shadow">
                                <div class="flex items-start gap-3">
                                    <span class="flex-shrink-0 w-8 h-8 bg-amber-500 text-white rounded-lg flex items-center justify-center font-bold text-sm">4</span>
                                    <div>
                                        <h4 class="font-bold text-slate-800">ì¤‘ìš”ë¬¸ì„œ ì‹œì ì¸ì¦ (íƒ€ì„ìŠ¤íƒ¬í”„) ê¸°ë¡ë³´í˜¸</h4>
                                        <p class="text-sm text-slate-600 mt-1">â€¢ ë¬¸ì„œë¥¼ "ì–¸ì œ ìƒì„±ëê³  ìœ„ë³€ì¡°ê°€ ì—†ë‹¤"ë¥¼ ì¦ëª…í•˜ëŠ” ì¥ì¹˜</p>
                                        <p class="text-sm text-slate-600">â€¢ ë¶„ìŸ/ì†Œëª…/ì¸ì • ê³¼ì •ì—ì„œ ì¦ë¹™ë ¥ì´ ë‹¬ë¼ì§ (ë²•ì ë³´í˜¸, ì•ˆì „ì¥ì¹˜)</p>
                                        <p class="text-sm text-slate-500 italic">â€¢ ì—°êµ¬ë…¸íŠ¸, ê·¼ë¡œê³„ì•½ì„œ, ì œíœ´í˜‘ì•½ì„œ, ê²¬ì ì„œ ë“±</p>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- ê¸°ëŠ¥ 5 -->
                            <div class="bg-gradient-to-br from-slate-50 to-slate-100 rounded-xl p-4 border border-slate-200 hover:shadow-md transition-shadow">
                                <div class="flex items-start gap-3">
                                    <span class="flex-shrink-0 w-8 h-8 bg-sky-600 text-white rounded-lg flex items-center justify-center font-bold text-sm">5</span>
                                    <div>
                                        <h4 class="font-bold text-slate-800">ë¬¸ì„œë³´ê´€/ìë£Œì‹¤ (ì‚¬ë‚´ ì¸íŠ¸ë¼ë„· ê¸°ëŠ¥)</h4>
                                        <p class="text-sm text-slate-600 mt-1">â€¢ íšŒì‚¬ ê·œì •/ì–‘ì‹/ê³„ì•½ì„œ/êµìœ¡ìë£Œ/íšŒì˜ë¡/ì¦ë¹™ ë“±ì„ ë³´ê´€</p>
                                        <p class="text-sm text-slate-600">â€¢ ë‹´ë‹¹ì ë°”ë€Œì–´ë„ ìš´ì˜ ì•ˆì •</p>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- ê¸°ëŠ¥ 6 -->
                            <div class="bg-gradient-to-br from-slate-50 to-slate-100 rounded-xl p-4 border border-slate-200 hover:shadow-md transition-shadow">
                                <div class="flex items-start gap-3">
                                    <span class="flex-shrink-0 w-8 h-8 bg-sky-600 text-white rounded-lg flex items-center justify-center font-bold text-sm">6</span>
                                    <div>
                                        <h4 class="font-bold text-slate-800">ì—…ë¬´ì¼ì§€ (ì „ ì§ì› ê³µìš©)</h4>
                                        <p class="text-sm text-slate-600 mt-1">â€¢ ì¼ì¼ ì—…ë¬´ê¸°ë¡, ì—…ë¬´ë‚´ìš©ë³´ê´€, ì—…ë¬´ì´ìŠˆ ìƒì‹œê¸°ë¡ë³´ê´€</p>
                                        <p class="text-sm text-slate-600">â€¢ CEO ì „ì‚¬ ì—…ë¬´í˜„í™© íŒŒì•… ìš©ì´</p>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- ê¸°ëŠ¥ 7 -->
                            <div class="bg-gradient-to-br from-slate-50 to-slate-100 rounded-xl p-4 border border-slate-200 hover:shadow-md transition-shadow">
                                <div class="flex items-start gap-3">
                                    <span class="flex-shrink-0 w-8 h-8 bg-sky-600 text-white rounded-lg flex items-center justify-center font-bold text-sm">7</span>
                                    <div>
                                        <h4 class="font-bold text-slate-800">ì¶œí‡´ê·¼ ê´€ë¦¬ (ì „ ì§ì›)</h4>
                                        <p class="text-sm text-slate-600 mt-1">â€¢ ì¶œí‡´ê·¼ ê¸°ë¡, ê·¼íƒœ ë°ì´í„° ëˆ„ì </p>
                                        <p class="text-sm text-slate-600">â€¢ ì‹œê°„ì™¸ìˆ˜ë‹¹ ë° ê³„ì•½ì§ ê¸‰ì—¬ê´€ë¦¬ ê³„ì‚° ìš©ì´</p>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- ê¸°ëŠ¥ 8 -->
                            <div class="bg-gradient-to-br from-violet-50 to-purple-50 rounded-xl p-4 border border-violet-200 hover:shadow-md transition-shadow">
                                <div class="flex items-start gap-3">
                                    <span class="flex-shrink-0 w-8 h-8 bg-violet-600 text-white rounded-lg flex items-center justify-center font-bold text-sm">8</span>
                                    <div>
                                        <h4 class="font-bold text-slate-800">ìƒì„±í˜• AI ì¢…ëŸ‰ì œ ì´ìš©</h4>
                                        <p class="text-sm text-slate-600 mt-1">â€¢ GPT, Gemini ì¢…ëŸ‰ì œ í† í°êµ¬ì… ì´ìš©</p>
                                        <p class="text-sm text-slate-600">â€¢ UI (ë² íƒ€ë²„ì „ ì œê³µ)</p>
                                        <p class="text-sm text-violet-600 font-medium">â€¢ ìƒë°˜ê¸° ë³€í™”: ì •ì‹ë²„ì „ UIì œê³µ, Claude, Perplexity ì‚¬ìš© ì¶”ê°€</p>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- ê¸°ëŠ¥ 9 -->
                            <div class="bg-gradient-to-br from-violet-50 to-purple-50 rounded-xl p-4 border border-violet-200 hover:shadow-md transition-shadow">
                                <div class="flex items-start gap-3">
                                    <span class="flex-shrink-0 w-8 h-8 bg-violet-600 text-white rounded-lg flex items-center justify-center font-bold text-sm">9</span>
                                    <div>
                                        <h4 class="font-bold text-slate-800">1:1 ê³ ê°ì„¼í„° AI íƒ‘ì¬</h4>
                                        <p class="text-sm text-slate-600 mt-1">â€¢ ê³ ê°ë¬¸ì˜ â†’ AI ë˜ëŠ” ì§ì› ì¤‘ ì„ íƒ</p>
                                        <p class="text-sm text-slate-600">â€¢ AIë¬¸ì˜ì‹œ RAGë°©ì‹ ìë™ë‹µë³€ ì‹œìŠ¤í…œ íƒ‘ì¬ (ë¬¸ì„œê¸°ë°˜ ìë™ì‘ë‹µ)</p>
                                        <p class="text-sm text-slate-600">â€¢ ë‹¨ìˆœ, ë°˜ë³µì§ˆë¬¸ì— ëŒ€í•˜ì—¬ AIê°€ ìë™ë‹µë³€</p>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- ê¸°ëŠ¥ 10 -->
                            <div class="bg-gradient-to-br from-emerald-50 to-teal-50 rounded-xl p-4 border border-emerald-200 hover:shadow-md transition-shadow">
                                <div class="flex items-start gap-3">
                                    <span class="flex-shrink-0 w-8 h-8 bg-emerald-600 text-white rounded-lg flex items-center justify-center font-bold text-sm">10</span>
                                    <div>
                                        <h4 class="font-bold text-slate-800">ë²•ì •ì˜ë¬´êµìœ¡ ì—°ë™ <span class="text-xs bg-emerald-100 text-emerald-700 px-2 py-0.5 rounded-full ml-1">íšŒì›ì‚¬ í˜œíƒ</span></h4>
                                        <p class="text-sm text-slate-600 mt-1">â€¢ ì „ì§ì› ë²•ì •ì˜ë¬´ êµìœ¡ë¹„ íšŒì›ê°€ ì œê³µ (ì‹œì¥ í‰ê· ê°€ì˜ 50% ìˆ˜ì¤€)</p>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- ê¸°ëŠ¥ 11 -->
                            <div class="bg-gradient-to-br from-emerald-50 to-teal-50 rounded-xl p-4 border border-emerald-200 hover:shadow-md transition-shadow">
                                <div class="flex items-start gap-3">
                                    <span class="flex-shrink-0 w-8 h-8 bg-emerald-600 text-white rounded-lg flex items-center justify-center font-bold text-sm">11</span>
                                    <div>
                                        <h4 class="font-bold text-slate-800">ì¢…í•©ê±´ê°•ê²€ì§„ <span class="text-xs bg-emerald-100 text-emerald-700 px-2 py-0.5 rounded-full ml-1">íšŒì›ì‚¬ í˜œíƒ</span></h4>
                                        <p class="text-sm text-slate-600 mt-1">â€¢ ëŒ€ê¸°ì—… ìˆ˜ê°€ ì œê³µ</p>
                                        <p class="text-sm text-slate-600">â€¢ ëŒ€ìƒ: ì „ì„ì§ì› ë° ê°€ì¡±ê¹Œì§€</p>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- ê¸°ëŠ¥ 12 -->
                            <div class="bg-gradient-to-br from-slate-50 to-slate-100 rounded-xl p-4 border border-slate-200 hover:shadow-md transition-shadow">
                                <div class="flex items-start gap-3">
                                    <span class="flex-shrink-0 w-8 h-8 bg-sky-600 text-white rounded-lg flex items-center justify-center font-bold text-sm">12</span>
                                    <div>
                                        <h4 class="font-bold text-slate-800">ESGê²½ì˜ ì „ìš©í˜ì´ì§€ ì œê³µ</h4>
                                        <p class="text-sm text-slate-600 mt-1">â€¢ ESG ì‹¤ì²œì‚¬í•­ì„ ê²Œì‹œÂ·ì¶•ì í•˜ëŠ” ì „ìš© ì½”ë„ˆ</p>
                                        <p class="text-sm text-slate-600">â€¢ ê±°ë˜ì²˜ í˜¹ì€ ê¸°ê´€ì´ ESG ìš”êµ¬í•  ë•Œ "ë¬¸ì„œê°€ ì•„ë‹Œ í™ˆí˜ì´ì§€ë¡œ ì‚¬ì‹¤ì¦ëª…"</p>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- ê¸°ëŠ¥ 13 -->
                            <div class="bg-gradient-to-br from-slate-50 to-slate-100 rounded-xl p-4 border border-slate-200 hover:shadow-md transition-shadow">
                                <div class="flex items-start gap-3">
                                    <span class="flex-shrink-0 w-8 h-8 bg-sky-600 text-white rounded-lg flex items-center justify-center font-bold text-sm">13</span>
                                    <div>
                                        <h4 class="font-bold text-slate-800">ê´€ë¦¬ì í˜ì´ì§€ (ìš´ì˜ í†µì œ)</h4>
                                        <p class="text-sm text-slate-600 mt-1">â€¢ ê¸°ì—…ë§ì¶¤í˜• ì „ìš© ê´€ë¦¬ì í˜ì´ì§€ ì œê³µ</p>
                                        <p class="text-sm text-slate-600">â€¢ ë©”ë‰´ëª…ì¹­ ë³€ê²½, ì´ë¯¸ì§€ ë³€ê²½, ì½˜í…ì¸ ì—…ë¡œë“œ ë“± í†µí•© ê´€ë¦¬</p>
                                        <p class="text-sm text-slate-600">â€¢ ì™¸ì£¼ ì˜ì¡´ ì—†ì´ ë‚´ë¶€ì—ì„œ ë°”ë¡œ ìˆ˜ì •/í†µì œ</p>
                                        <p class="text-sm text-sky-600 font-medium">â€¢ ì‹ ì†í•œ ë³€ê²½, ì—…ë°ì´íŠ¸ ë° ìœ ì§€ë³´ìˆ˜ ë¹„ìš© ì œë¡œí™”</p>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- ê¸°ëŠ¥ 14 -->
                            <div class="bg-gradient-to-br from-slate-50 to-slate-100 rounded-xl p-4 border border-slate-200 hover:shadow-md transition-shadow">
                                <div class="flex items-start gap-3">
                                    <span class="flex-shrink-0 w-8 h-8 bg-sky-600 text-white rounded-lg flex items-center justify-center font-bold text-sm">14</span>
                                    <div>
                                        <h4 class="font-bold text-slate-800">ì „ ì„ì§ì› ê°œë³„ì‚¬ìš©</h4>
                                        <p class="text-sm text-slate-600 mt-1">â€¢ ì§ì›ë³„ ë¡œê·¸ì¸ê¸°ëŠ¥ ì‚¬ìš©</p>
                                        <p class="text-sm text-slate-600">â€¢ ì±…ì„ìê°€ ì „ì„ì§ì› ì½˜íŠ¸ë¡¤ (ì§ì› ê³„ì •ì„ ì§ì ‘ ìƒì„±í•´ì„œ ì œê³µ)</p>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- ê¸°ëŠ¥ 15 -->
                            <div class="bg-gradient-to-br from-rose-50 to-pink-50 rounded-xl p-4 border border-rose-200 hover:shadow-md transition-shadow">
                                <div class="flex items-start gap-3">
                                    <span class="flex-shrink-0 w-8 h-8 bg-gradient-to-r from-rose-500 to-pink-500 text-white rounded-lg flex items-center justify-center font-bold text-sm">15</span>
                                    <div>
                                        <h4 class="font-bold text-slate-800">2026ë…„ ì¶”ê°€ í”„ë¡œê·¸ë¨ <span class="text-xs bg-rose-100 text-rose-700 px-2 py-0.5 rounded-full ml-1">Coming Soon</span></h4>
                                        <p class="text-sm text-slate-600 mt-1">â€¢ ì¶œí‡´ê·¼ í”„ë¡œê·¸ë¨ (2ì›” ëŸ°ì¹­)</p>
                                        <p class="text-sm text-slate-600">â€¢ ì¸ì‚¬ë…¸ë¬´ ê´€ë¦¬ í”„ë¡œê·¸ë¨</p>
                                        <p class="text-sm text-slate-600">â€¢ ìƒì„±í˜• AI UI ì—…ë°ì´íŠ¸</p>
                                        <p class="text-sm text-slate-600">â€¢ AIì¢…ëŸ‰ì œ ì¶”ê°€êµ¬ì¶• (Claude, Perplexity)</p>
                                        <p class="text-sm text-slate-600">â€¢ ê¸°ì—…ë³„ ê²°ì œì‹œìŠ¤í…œ êµ¬ì¶•</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- í‘¸í„° -->
                        <div class="px-6 py-4 bg-slate-50 border-t">
                            <button type="button" onclick="closeFeaturesModal()" class="w-full py-3 bg-gradient-to-r from-slate-800 to-slate-900 hover:from-slate-900 hover:to-black text-white font-bold rounded-xl transition-all shadow-lg hover:shadow-xl">ë‹«ê¸°</button>
                        </div>
                    </div>
                </div>
                
                <!-- ê°€ê²©í‘œ ëª¨ë‹¬ -->
                <div id="price-table-modal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
                    <div class="bg-white rounded-2xl shadow-xl max-w-md w-full mx-4 overflow-hidden">
                        <div class="bg-teal-600 text-white px-6 py-4">
                            <h3 class="text-xl font-bold text-center">ê¸°ì—…í™ˆí˜ì´ì§€ ê°€ê²©í‘œ</h3>
                        </div>
                        <div class="p-6">
                            <table class="w-full text-sm">
                                <tbody class="divide-y">
                                    <tr class="hover:bg-slate-50">
                                        <td class="py-3 font-semibold text-slate-700">ì œì‘ë¹„</td>
                                        <td class="py-3 text-right text-teal-600 font-bold">ë¬´ë£Œ</td>
                                    </tr>
                                    <tr class="hover:bg-slate-50">
                                        <td class="py-3 font-semibold text-slate-700">ìœ ì§€/ë³´ìˆ˜ ë¹„ìš©</td>
                                        <td class="py-3 text-right text-teal-600 font-bold">ì—†ìŒ</td>
                                    </tr>
                                    <tr class="hover:bg-slate-50">
                                        <td class="py-3 font-semibold text-slate-700">ì´ˆê¸°ì…‹íŒ…ë¹„</td>
                                        <td class="py-3 text-right font-bold">100ë§Œì›</td>
                                    </tr>
                                    <tr class="hover:bg-slate-50">
                                        <td class="py-3 font-semibold text-slate-700">ì„œë²„ë“±ë¡ë¹„ (1íšŒ)</td>
                                        <td class="py-3 text-right font-bold">10ë§Œì›</td>
                                    </tr>
                                    <tr class="hover:bg-slate-50">
                                        <td class="py-3 font-semibold text-slate-700">ì›”ì´ìš©ë£Œ</td>
                                        <td class="py-3 text-right font-bold">10ë§Œì›</td>
                                    </tr>
                                    <tr class="hover:bg-slate-50">
                                        <td class="py-3 font-semibold text-slate-700">ì›¹í˜¸ìŠ¤íŒ…ë¹„</td>
                                        <td class="py-3 text-right text-slate-500">ì´ìš©ëŸ‰ì— ë”°ë¼ ê²°ì •</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                        <div class="px-6 pb-6">
                            <button type="button" onclick="closePriceTableModal()" class="w-full py-3 bg-slate-800 hover:bg-slate-900 text-white font-bold rounded-lg">ë‹«ê¸°</button>
                        </div>
                    </div>
                </div>
                
                <script>
                    function showFeaturesModal() {
                        document.getElementById('features-modal').classList.remove('hidden');
                    }
                    function closeFeaturesModal() {
                        document.getElementById('features-modal').classList.add('hidden');
                    }
                    function showPriceTableModal() {
                        document.getElementById('price-table-modal').classList.remove('hidden');
                    }
                    function closePriceTableModal() {
                        document.getElementById('price-table-modal').classList.add('hidden');
                    }
                    document.addEventListener('DOMContentLoaded', function() {
                        document.getElementById('price-table-modal')?.addEventListener('click', function(e) {
                            if (e.target === this) closePriceTableModal();
                        });
                        document.getElementById('features-modal')?.addEventListener('click', function(e) {
                            if (e.target === this) closeFeaturesModal();
                        });
                    });
                </script>
            </div>
        </div>
    </div>

    <!-- ê´€ë¦¬ì í˜ì´ì§€ -->
    <div id="admin-page" class="hidden">
        <div class="full-width-container">
            <header class="mb-4 flex flex-wrap justify-between items-center gap-4">
                <div><h1 class="text-2xl md:text-3xl font-bold text-slate-800">ê´€ë¦¬ì í˜ì´ì§€</h1></div>
                <div class="flex gap-2">
                    <button onclick="showPage('TM-DB-Table')" class="py-2 px-4 text-sm font-semibold rounded-lg text-slate-700 bg-slate-200 hover:bg-slate-300 transition">DB í˜„í™©</button>
                    <button onclick="logout()" class="py-2 px-4 text-sm font-semibold rounded-lg text-red-600 bg-red-100 hover:bg-red-200 transition">ë¡œê·¸ì•„ì›ƒ</button>
                </div>
            </header>
            <div class="bg-white rounded-xl shadow-lg mb-4">
                <div class="p-4 border-b"><h2 class="text-lg font-semibold text-slate-800">ê´€ë¦¬ì ì •ë³´ ë³€ê²½</h2></div>
                <form id="admin-credential-form" class="p-4">
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4 items-end">
                        <div>
                            <label for="new-admin-id" class="text-sm font-semibold text-slate-700">ìƒˆë¡œìš´ ì•„ì´ë””</label>
                            <input id="new-admin-id" type="text" required class="mt-1 block w-full px-3 py-2 bg-slate-50 border rounded-md">
                        </div>
                        <div>
                            <label for="new-admin-pw" class="text-sm font-semibold text-slate-700">ìƒˆë¡œìš´ ë¹„ë°€ë²ˆí˜¸</label>
                            <input id="new-admin-pw" type="password" required class="mt-1 block w-full px-3 py-2 bg-slate-50 border rounded-md">
                        </div>
                        <div><button type="submit" class="w-full py-2 px-4 font-bold rounded-lg text-white bg-slate-800 hover:bg-slate-900">ì €ì¥</button></div>
                    </div>
                </form>
            </div>
            <!-- ìŠ¤ì¼€ì¤„ ê´€ë¦¬ ì„¹ì…˜ -->
            <div class="bg-white rounded-xl shadow-lg mb-4">
                <div class="p-4 border-b"><h2 class="text-lg font-semibold text-slate-800">ğŸ“… ë‹¤ìŒ ì£¼ ì „ë¬¸ìœ„ì› ìŠ¤ì¼€ì¤„</h2></div>
                <div class="p-4">
                    <div id="admin-schedule-container" class="overflow-x-auto">
                        <table class="w-full text-sm text-left text-slate-600">
                            <thead class="text-xs text-slate-700 uppercase bg-slate-100">
                                <tr>
                                    <th class="px-4 py-3">ì „ë¬¸ìœ„ì›</th>
                                    <th class="px-4 py-3">ì‹ ì²­ì¼ì</th>
                                    <th class="px-4 py-3">ìƒíƒœ</th>
                                    <th class="px-4 py-3">ì²˜ë¦¬ì¼ì‹œ</th>
                                    <th class="px-4 py-3 text-center">ê´€ë¦¬</th>
                                </tr>
                            </thead>
                            <tbody id="admin-schedule-body"></tbody>
                        </table>
                    </div>
                    <p id="no-schedule-msg" class="text-center py-8 text-slate-500 hidden">ì‹ ì²­ëœ ìŠ¤ì¼€ì¤„ì´ ì—†ìŠµë‹ˆë‹¤.</p>
                </div>
            </div>

            <div class="bg-white rounded-xl shadow-lg overflow-hidden">
                <div class="p-4 border-b"><h2 class="text-lg font-semibold text-slate-800">íšŒì› ì •ë³´ í˜„í™©</h2></div>
                <div class="w-full overflow-x-auto">
                    <table class="w-full text-sm text-left text-slate-600">
                        <thead class="text-xs text-slate-700 uppercase bg-slate-100">
                            <tr>
                                <th class="px-4 py-3">êµ¬ë¶„</th>
                                <th class="px-4 py-3">ì„±ëª…</th>
                                <th class="px-4 py-3">ì „í™”ë²ˆí˜¸</th>
                                <th class="px-4 py-3">ì†Œì†ì‚¬</th>
                                <th class="px-4 py-3">ì§€ì—­</th>
                                <th class="px-4 py-3">ì œê³µë¹ˆë„</th>
                                <th class="px-4 py-3">ë©¤ë²„ì‹­</th>
                                <th class="px-4 py-3 text-center">ê´€ë¦¬</th>
                            </tr>
                        </thead>
                        <tbody id="admin-table-body"></tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
    
    <!-- DB í…Œì´ë¸” í˜ì´ì§€ -->
    <div id="TM-DB-Table" class="hidden">
         <div class="full-width-container">
            <header class="mb-4 flex flex-wrap justify-between items-center gap-4">
                <div><h1 class="text-2xl md:text-3xl font-bold text-slate-800">ì—°êµ¬ì†Œ DB í˜„í™©</h1><p id="welcome-user" class="mt-1 text-sm text-slate-500"></p></div>
                <div class="flex gap-2 items-center">
                    <button id="admin-page-button" class="hidden py-2 px-4 text-sm font-semibold rounded-lg text-slate-700 bg-slate-200 hover:bg-slate-300 transition" onclick="showPage('admin-page')">ê´€ë¦¬ì</button>
                    <button onclick="logout()" class="py-2 px-4 text-sm font-semibold rounded-lg text-red-600 bg-red-100 hover:bg-red-200 transition">ë¡œê·¸ì•„ì›ƒ</button>
                </div>
            </header>
            
            <!-- ì „ë¬¸ìœ„ì› ìŠ¤ì¼€ì¤„ ì‹ ì²­ ì„¹ì…˜ (ì „ë¬¸ìœ„ì›ë§Œ í‘œì‹œ) -->
            <div id="specialist-schedule-section" class="hidden bg-white rounded-xl shadow-lg mb-4">
                <div class="p-4 border-b flex flex-wrap justify-between items-center gap-2">
                    <h2 class="text-lg font-semibold text-slate-800">ğŸ“… ë‹¤ìŒ ì£¼ ì½œ ì¼ì • ì‹ ì²­</h2>
                    <button onclick="saveSchedule()" class="py-2 px-4 text-sm font-bold rounded-lg text-white bg-amber-500 hover:bg-amber-600">ì‹ ì²­í•˜ê¸°</button>
                </div>
                <div class="p-4">
                    <div id="schedule-checkboxes" class="flex flex-wrap gap-3 justify-center"></div>
                    <div id="my-schedule-status" class="mt-4 pt-4 border-t">
                        <h3 class="text-sm font-semibold text-slate-700 mb-2">ë‚˜ì˜ ì‹ ì²­ í˜„í™©</h3>
                        <div id="my-schedule-list" class="flex flex-wrap gap-2"></div>
                    </div>
                </div>
            </div>

            <div class="bg-white rounded-xl shadow-lg overflow-hidden">
                <div class="p-3 flex flex-wrap gap-2 justify-between items-center border-b">
                    <div class="flex items-center gap-2">
                        <h2 class="text-lg font-semibold text-slate-800">ê¸°ì—… ë¦¬ìŠ¤íŠ¸</h2>
                        <span id="data-count-display" class="text-sm text-slate-500"></span>
                    </div>
                    <div id="filter-container" class="flex items-center gap-2">
                        <select id="search-column-select" class="border rounded-md p-2 text-sm bg-white">
                            <option value="ê¸°ì—…ëª…">ê¸°ì—…ëª…</option>
                            <option value="ë‹´ë‹¹ ì „ë¬¸ìœ„ì›">ë‹´ë‹¹ ì „ë¬¸ìœ„ì›</option>
                        </select>
                        <input type="text" id="search-input" class="w-40 md:w-56 border rounded-md p-2 text-sm" placeholder="ê²€ìƒ‰ì–´ ì…ë ¥" onkeydown="if(event.key==='Enter') searchCompany();">
                        <button onclick="searchCompany()" class="py-2 px-3 text-sm font-bold rounded-lg text-white bg-slate-700 hover:bg-slate-800">ê²€ìƒ‰</button>
                        <button onclick="resetSearch()" class="py-2 px-3 text-sm font-semibold rounded-lg text-slate-700 bg-slate-200 hover:bg-slate-300">ì´ˆê¸°í™”</button>
                    </div>
                </div>
                <div class="w-full overflow-x-auto">
                    <table class="w-full text-sm text-left text-slate-600">
                        <thead class="text-xs text-slate-700 uppercase bg-slate-100">
                            <tr class="border-b-2">
                                <th colspan="11" class="px-4 py-2 font-bold text-center bg-blue-100 text-blue-800">ê¸°ì—… ê¸°ë³¸ì •ë³´</th>
                                <th colspan="6" class="px-4 py-2 font-bold text-center bg-green-100 text-green-800">ì „ë¬¸ìœ„ì› ì…ë ¥</th>
                                <th colspan="2" class="px-4 py-2 font-bold text-center bg-amber-100 text-amber-800">ë³¸ì‚¬</th>
                            </tr>
                            <tr class="border-b">
                                <!-- A~Kì—´: ê¸°ì—… ê¸°ë³¸ì •ë³´ -->
                                <th class="px-3 py-2 min-w-[50px]">No</th>
                                <th class="px-3 py-2 min-w-[150px]">ê¸°ì—…ëª…</th>
                                <th class="px-3 py-2 min-w-[100px]">ì—…ì¢…</th>
                                <th class="px-3 py-2 min-w-[80px]">ê¸°ì—…ê·œëª¨</th>
                                <th class="px-3 py-2 min-w-[200px]">íšŒì‚¬ì£¼ì†Œ</th>
                                <th class="px-3 py-2 min-w-[200px]">ì—°êµ¬ì†Œì£¼ì†Œ</th>
                                <th class="px-3 py-2 min-w-[80px]">êµ¬ë¶„</th>
                                <th class="px-3 py-2 min-w-[120px]">íšŒì‚¬Tel</th>
                                <th class="px-3 py-2 min-w-[120px]">íšŒì‚¬Fax</th>
                                <th class="px-3 py-2 min-w-[80px]">ëŒ€í‘œìëª…</th>
                                <th class="px-3 py-2 min-w-[100px]">ë‹´ë‹¹ì „ë¬¸ìœ„ì›</th>
                                <!-- ì „ë¬¸ìœ„ì› ì…ë ¥í•­ëª© (6ê°œ) -->
                                <th class="px-3 py-2 min-w-[90px]">ì½œì¼ì</th>
                                <th class="px-3 py-2 min-w-[80px]">í†µí™”ëŒ€ìƒì</th>
                                <th class="px-3 py-2 min-w-[70px]">ì§í•¨</th>
                                <th class="px-3 py-2 min-w-[200px]">í†µí™”ë‚´ìš©</th>
                                <th class="px-3 py-2 min-w-[100px]">ë³¸ì‚¬ìƒë‹´ìš”ì²­</th>
                                <th class="px-3 py-2 min-w-[100px]">í™ˆí”¼ì•ˆë‚´ì¼</th>
                                <!-- ë³¸ì‚¬ ì…ë ¥í•­ëª© (2ê°œ) -->
                                <th class="px-3 py-2 min-w-[150px]">í™ˆí˜ì´ì§€url</th>
                                <th class="px-3 py-2 min-w-[200px]">ë³¸ì‚¬ë©”ëª¨</th>
                            </tr>
                        </thead>
                        <tbody id="db-table-body"></tbody>
                    </table>
                </div>
                <div id="pagination-controls" class="p-3 flex justify-center items-center gap-2 border-t">
                    <div id="page-buttons-container" class="flex items-center gap-1"></div>
                    <div id="page-jump-container" class="flex items-center gap-2 ml-4">
                        <input type="number" id="page-jump-input" class="w-16 border rounded-md p-2 text-sm" placeholder="í˜ì´ì§€" onkeydown="if(event.key==='Enter') jumpToPage();">
                        <button onclick="jumpToPage()" class="px-3 py-2 rounded-md text-sm font-medium bg-slate-600 text-white hover:bg-slate-700">ì´ë™</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- ìƒì„¸ ì •ë³´ ëª¨ë‹¬ -->
    <div id="edit-modal" class="hidden fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50 p-4">
        <div class="w-full max-w-5xl bg-white rounded-2xl shadow-xl flex flex-col max-h-[90vh]">
            <header class="p-6 border-b flex justify-between items-center">
                <h2 id="modal-title" class="text-2xl font-bold text-slate-800">ìƒì„¸ ì •ë³´ ì…ë ¥</h2>
                <button onclick="closeEditModal()" class="text-gray-400 hover:text-gray-600 text-3xl">&times;</button>
            </header>

            <div id="modal-warning" class="hidden p-4 text-sm text-amber-800 bg-amber-100 text-center font-semibold"></div>

            <div class="p-8 modal-body overflow-y-auto">
                <form id="edit-form" onkeydown="handleEnterKey(event)">
                    <input name="originalIndex" type="hidden">
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-x-8 gap-y-6">
                        
                        <!-- ê¸°ì—… ê¸°ë³¸ì •ë³´ (A~Kì—´) -->
                        <fieldset id="company-info-fieldset" class="lg:col-span-3 grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-x-8 gap-y-6">
                            <legend class="lg:col-span-3 font-bold text-lg text-blue-800 border-b-2 border-blue-200 pb-2 mb-4">ê¸°ì—… ê¸°ë³¸ì •ë³´</legend>
                            <input name="No" type="hidden">
                            <div><label class="font-semibold">ê¸°ì—…ëª…</label><input name="ê¸°ì—…ëª…" type="text" class="w-full p-2 mt-1 border rounded" readonly></div>
                            <div><label class="font-semibold">ì—…ì¢…</label><input name="ì—…ì¢…" type="text" class="w-full p-2 mt-1 border rounded" readonly></div>
                            <div><label class="font-semibold">ê¸°ì—…ê·œëª¨</label><input name="ê¸°ì—…ê·œëª¨" type="text" class="w-full p-2 mt-1 border rounded" readonly></div>
                            <div class="lg:col-span-3"><label class="font-semibold">íšŒì‚¬ì£¼ì†Œ</label><input name="íšŒì‚¬ì£¼ì†Œ" type="text" class="w-full p-2 mt-1 border rounded" readonly></div>
                            <div class="lg:col-span-3"><label class="font-semibold">ì—°êµ¬ì†Œì£¼ì†Œ</label><input name="ì—°êµ¬ì†Œì£¼ì†Œ" type="text" class="w-full p-2 mt-1 border rounded" readonly></div>
                            <div><label class="font-semibold">êµ¬ë¶„</label><input name="êµ¬ë¶„" type="text" class="w-full p-2 mt-1 border rounded" readonly></div>
                            <div><label class="font-semibold">íšŒì‚¬Tel</label><input name="íšŒì‚¬Tel" type="text" class="w-full p-2 mt-1 border rounded" readonly></div>
                            <div><label class="font-semibold">íšŒì‚¬Fax</label><input name="íšŒì‚¬Fax" type="text" class="w-full p-2 mt-1 border rounded" readonly></div>
                            <div><label class="font-semibold">ëŒ€í‘œìëª…</label><input name="ëŒ€í‘œìëª…" type="text" class="w-full p-2 mt-1 border rounded" readonly></div>
                            <div><label class="font-semibold">ë‹´ë‹¹ ì „ë¬¸ìœ„ì›</label><input name="ë‹´ë‹¹ ì „ë¬¸ìœ„ì›" type="text" class="w-full p-2 mt-1 border rounded bg-gray-100" readonly></div>
                        </fieldset>
                        
                        <!-- ì „ë¬¸ìœ„ì› ì…ë ¥í•­ëª© -->
                        <fieldset id="specialist-fieldset" class="lg:col-span-3 grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-x-8 gap-y-6">
                            <legend class="lg:col-span-3 font-bold text-lg text-green-800 border-b-2 border-green-200 pb-2 mb-4 mt-6">ì „ë¬¸ìœ„ì› ì…ë ¥í•­ëª©</legend>
                            <div>
                                <label class="font-semibold flex items-center">ì½œì¼ì</label>
                                <input name="ì½œì¼ì" type="text" class="w-full p-2 mt-1 border rounded" placeholder="ì˜ˆ: 2025-01-10">
                            </div>
                            <div>
                                <label class="font-semibold flex items-center">í†µí™”ëŒ€ìƒì</label>
                                <input name="í†µí™”ëŒ€ìƒì" type="text" class="w-full p-2 mt-1 border rounded">
                            </div>
                            <div>
                                <label class="font-semibold flex items-center">ì§í•¨</label>
                                <input name="ì§í•¨" type="text" list="job-title-list" class="w-full p-2 mt-1 border rounded" placeholder="ì„ íƒ ë˜ëŠ” ì§ì ‘ì…ë ¥">
                                <datalist id="job-title-list">
                                    <option value="ëŒ€í‘œ">
                                    <option value="ì—°êµ¬ì†Œì¥">
                                    <option value="ì±…ì„ì">
                                    <option value="ë¶€ì¥">
                                    <option value="ê¸°íƒ€">
                                </datalist>
                            </div>
                            <div class="lg:col-span-3">
                                <label class="font-semibold flex items-center">í†µí™”ë‚´ìš©_ì „ë¬¸ìœ„ì›</label>
                                <textarea name="í†µí™”ë‚´ìš©_ì „ë¬¸ìœ„ì›" rows="3" class="w-full p-2 mt-1 border rounded"></textarea>
                            </div>
                            <div>
                                <label class="font-semibold flex items-center">ë³¸ì‚¬ìƒë‹´ìš”ì²­</label>
                                <select name="ë³¸ì‚¬ìƒë‹´ìš”ì²­" class="w-full p-2 mt-1 border rounded">
                                    <option value="">ì„ íƒ</option>
                                    <option value="ìš”ì²­(ê´€ì‹¬ë„_ë†’ìŒ)">ìš”ì²­(ê´€ì‹¬ë„_ë†’ìŒ)</option>
                                    <option value="ìš”ì²­(ê´€ì‹¬ë„_ë³´í†µ)">ìš”ì²­(ê´€ì‹¬ë„_ë³´í†µ)</option>
                                    <option value="ìš”ì²­(ê´€ì‹¬ë„_ë‚®ìŒ)">ìš”ì²­(ê´€ì‹¬ë„_ë‚®ìŒ)</option>
                                    <option value="ëŒ€ìƒì•„ë‹˜">ëŒ€ìƒì•„ë‹˜</option>
                                    <option value="ì¶”í›„ì§„í–‰">ì¶”í›„ì§„í–‰</option>
                                </select>
                            </div>
                            <div>
                                <label class="font-semibold flex items-center">í™ˆí˜ì´ì§€ì•ˆë‚´ì¼ì</label>
                                <input name="í™ˆí˜ì´ì§€ì•ˆë‚´ì¼ì" type="text" class="w-full p-2 mt-1 border rounded" placeholder="ì˜ˆ: 2025-01-10">
                            </div>
                        </fieldset>
                        
                        <!-- ë³¸ì‚¬ ì…ë ¥í•­ëª© -->
                        <fieldset id="hq-fieldset" class="lg:col-span-3 grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-x-8 gap-y-6">
                            <legend class="lg:col-span-3 font-bold text-lg text-amber-800 border-b-2 border-amber-200 pb-2 mb-4 mt-6">ë³¸ì‚¬ ì…ë ¥í•­ëª©</legend>
                            <div>
                                <label class="font-semibold flex items-center">í™ˆí˜ì´ì§€url</label>
                                <input name="í™ˆí˜ì´ì§€url" type="text" class="w-full p-2 mt-1 border rounded">
                            </div>
                            <div class="lg:col-span-2">
                                <label class="font-semibold flex items-center">ë³¸ì‚¬ë‹´ë‹¹ìë©”ëª¨</label>
                                <textarea name="ë³¸ì‚¬ë‹´ë‹¹ìë©”ëª¨" rows="2" class="w-full p-2 mt-1 border rounded"></textarea>
                            </div>
                        </fieldset>
                        
                    </div>
                </form>
            </div>
            <footer class="p-6 border-t flex justify-between items-center gap-4">
                <button id="delete-button" onclick="deleteCompany()" class="hidden py-3 px-6 font-bold rounded-lg text-red-600 bg-red-100 hover:bg-red-200 transition">ì‚­ì œ</button>
                <div class="flex gap-4 ml-auto">
                    <button type="button" onclick="closeEditModal()" class="py-3 px-8 font-bold rounded-lg text-slate-700 bg-slate-200 hover:bg-slate-300">ì·¨ì†Œ</button>
                    <button type="button" onclick="saveModalData()" class="py-3 px-8 font-bold rounded-lg text-white bg-slate-800 hover:bg-slate-900">ì €ì¥</button>
                </div>
            </footer>
        </div>
    </div>

<script>
    // === ì „ì—­ ë³€ìˆ˜ ===
    const GAS_API_URL = 'https://script.google.com/macros/s/AKfycbxT_jFERIyCqadOsT1FQxNu-L-tclH7FT87czgrtZey_PzTVp0S2HRzoJ5F-e1iS8ow/exec';
    let loggedInUser = null;
    let allUsers = [];
    let allCompanies = [];
    let cachedAllCompanies = []; // ì „ì²´ ë°ì´í„° ìºì‹œ
    let totalCompanies = 0;
    let currentPage = 1;
    const companiesLimit = 10; // í•œ í™”ë©´ì— 10í–‰ í‘œì‹œ
    let currentFilter = {};

    // === API í˜¸ì¶œ ===
    function showLoading() { document.getElementById('loading-overlay').classList.remove('hidden'); }
    function hideLoading() { document.getElementById('loading-overlay').classList.add('hidden'); }

    async function callAPI(action, sheet, data = {}) {
        showLoading();
        try {
            const response = await fetch(GAS_API_URL, {
                method: 'POST',
                headers: { 'Content-Type': 'text/plain;charset=utf-8' },
                body: JSON.stringify({ action, sheet, ...data })
            });
            const result = await response.json();
            if (result.error) {
                console.error('API Error:', result.error);
                alert('ì˜¤ë¥˜ ë°œìƒ: ' + result.error);
                return null;
            }
            return result;
        } catch (error) {
            console.error('Fetch Error:', error);
            alert('ì„œë²„ì™€ í†µì‹  ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
            return null;
        } finally {
            hideLoading();
        }
    }

    // === í˜ì´ì§€ ì´ë™ ===
    function showPage(pageId) {
        document.querySelectorAll('body > div[id$="-page"], body > div[id="TM-DB-Table"], body > div[id="admin-page"]').forEach(p => p.classList.add('hidden'));
        document.getElementById(pageId)?.classList.remove('hidden');
        if (pageId === 'TM-DB-Table' && loggedInUser) {
            loadInitialData();
            if (loggedInUser.role === 'ì „ë¬¸ìœ„ì›') renderScheduleUI();
        }
        if (pageId === 'admin-page' && loggedInUser) {
            renderAdminTable();
            renderAdminSchedule();
        }
    }
    window.showPage = showPage;

    function logout() {
        loggedInUser = null;
        sessionStorage.removeItem('loggedInUser');
        allUsers = [];
        allCompanies = [];
        showPage('login-page');
    }
    window.logout = logout;

    // === ë¡œê·¸ì¸ ì²˜ë¦¬ ===
    document.getElementById('login-form').addEventListener('submit', async (e) => {
        e.preventDefault();
        const username = document.getElementById('username').value.trim();
        const password = document.getElementById('password').value.trim();
        
        // admin ë¡œê·¸ì¸ ì²´í¬
        const adminData = await callAPI('readAll', 'Admin');
        if (adminData && adminData.length > 0) {
            const admin = adminData[0];
            if (admin.id === username && String(admin.pw) === password) {
                loggedInUser = { name: 'ê´€ë¦¬ì', role: 'admin' };
                sessionStorage.setItem('loggedInUser', JSON.stringify(loggedInUser));
                showPage('admin-page');
                return;
            }
        }
        
        // ì¼ë°˜ ì‚¬ìš©ì ë¡œê·¸ì¸ ì²´í¬
        const users = await callAPI('readAll', 'Users');
        if (users) {
            allUsers = users;
            const user = users.find(u => u.name === username && u.phone === password);
            if (user) {
                loggedInUser = user;
                sessionStorage.setItem('loggedInUser', JSON.stringify(user));
                showPage('TM-DB-Table');
            } else {
                alert('ì•„ì´ë”” ë˜ëŠ” ë¹„ë°€ë²ˆí˜¸ê°€ ì¼ì¹˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.');
            }
        }
    });

    // === ê´€ë¦¬ì ì •ë³´ ë³€ê²½ ===
    document.getElementById('admin-credential-form').addEventListener('submit', async (e) => {
        e.preventDefault();
        const newId = document.getElementById('new-admin-id').value.trim();
        const newPw = document.getElementById('new-admin-pw').value.trim();
        if (newId && newPw) {
            const result = await callAPI('update', 'Admin', { data: { id: newId, pw: newPw }, rowIndex: 2 });
            alert('ê´€ë¦¬ì ì •ë³´ê°€ ì„±ê³µì ìœ¼ë¡œ ë³€ê²½ë˜ì—ˆìŠµë‹ˆë‹¤.');
        } else {
            alert('ìƒˆë¡œìš´ ì•„ì´ë””ì™€ ë¹„ë°€ë²ˆí˜¸ë¥¼ ëª¨ë‘ ì…ë ¥í•´ì£¼ì„¸ìš”.');
        }
    });

    // === ê´€ë¦¬ì í…Œì´ë¸” ë Œë”ë§ ===
    async function renderAdminTable() {
        await loadUsers();
        const tableBody = document.getElementById('admin-table-body');
        tableBody.innerHTML = '';
        if (allUsers.length === 0) {
            tableBody.innerHTML = `<tr><td colspan="8" class="text-center py-16 text-slate-500">ë“±ë¡ëœ íšŒì›ì´ ì—†ìŠµë‹ˆë‹¤.</td></tr>`;
            return;
        }
        allUsers.forEach((member, index) => {
            const row = document.createElement('tr');
            row.className = 'bg-white border-b';
            row.id = `user-row-${index}`;
            row.innerHTML = getUserRowHtml(member, index);
            tableBody.appendChild(row);
        });
    }

    function getUserRowHtml(member, index) {
        return `
            <td class="px-4 py-3 font-semibold">${member.role}</td>
            <td class="px-4 py-3">${member.name}</td>
            <td class="px-4 py-3">${member.phone}</td>
            <td class="px-4 py-3">${member.company || ''}</td>
            <td class="px-4 py-3">${member.region || ''}</td>
            <td class="px-4 py-3">${member.frequency || ''}</td>
            <td class="px-4 py-3">${member.Membership || ''}</td>
            <td class="px-4 py-3 text-center">
                <div class="flex justify-center items-center gap-2">
                    <button onclick="editUser(${index})" class="font-semibold text-blue-600 hover:text-blue-800">ìˆ˜ì •</button>
                    <button onclick="deleteUser(${index})" class="font-semibold text-red-500 hover:text-red-700">ì‚­ì œ</button>
                </div>
            </td>
        `;
    }

    function getEditUserRowHtml(member, index) {
        return `
            <td class="px-4 py-2">
                <select name="role" class="w-full p-1 border rounded bg-slate-50 text-sm">
                    <option value="TMer" ${member.role === 'TMer' ? 'selected' : ''}>TMer</option>
                    <option value="ì „ë¬¸ìœ„ì›" ${member.role === 'ì „ë¬¸ìœ„ì›' ? 'selected' : ''}>ì „ë¬¸ìœ„ì›</option>
                </select>
            </td>
            <td class="px-4 py-2"><input name="name" type="text" value="${member.name}" class="w-full p-1 border rounded bg-gray-200 text-sm" readonly></td>
            <td class="px-4 py-2"><input name="phone" type="text" value="${member.phone}" class="w-full p-1 border rounded bg-slate-50 text-sm"></td>
            <td class="px-4 py-2"><input name="company" type="text" value="${member.company || ''}" class="w-full p-1 border rounded bg-slate-50 text-sm"></td>
            <td class="px-4 py-2"><input name="region" type="text" value="${member.region || ''}" class="w-full p-1 border rounded bg-slate-50 text-sm" placeholder="ì„œìš¸, ê²½ê¸°"></td>
            <td class="px-4 py-2"><input name="frequency" type="text" value="${member.frequency || ''}" class="w-full p-1 border rounded bg-slate-50 text-sm" placeholder="ì£¼1íšŒ"></td>
            <td class="px-4 py-2"><input name="Membership" type="text" value="${member.Membership || ''}" class="w-full p-1 border rounded bg-slate-50 text-sm" placeholder="Branch"></td>
            <td class="px-4 py-2 text-center">
                <div class="flex justify-center items-center gap-2">
                    <button onclick="saveUser(${index})" class="font-semibold text-green-600 hover:text-green-800">ì €ì¥</button>
                    <button onclick="renderAdminTable()" class="font-semibold text-gray-600 hover:text-gray-800">ì·¨ì†Œ</button>
                </div>
            </td>
        `;
    }

    function editUser(index) {
        const row = document.getElementById(`user-row-${index}`);
        row.innerHTML = getEditUserRowHtml(allUsers[index], index);
    }
    window.editUser = editUser;

    async function saveUser(index) {
        const row = document.getElementById(`user-row-${index}`);
        const originalUser = allUsers[index];
        const updatedUserData = {
            role: row.querySelector('[name="role"]').value,
            name: row.querySelector('[name="name"]').value,
            phone: row.querySelector('[name="phone"]').value,
            company: row.querySelector('[name="company"]').value,
            region: row.querySelector('[name="region"]').value,
            frequency: row.querySelector('[name="frequency"]').value,
            Membership: row.querySelector('[name="Membership"]').value
        };
        const result = await callAPI('update', 'Users', { data: updatedUserData, rowIndex: originalUser.originalIndex });
        if (result && result.success) {
            alert('íšŒì› ì •ë³´ê°€ ìˆ˜ì •ë˜ì—ˆìŠµë‹ˆë‹¤.');
            allUsers = [];
            await renderAdminTable();
        }
    }
    window.saveUser = saveUser;

    async function deleteUser(index) {
        const userToDelete = allUsers[index];
        if (confirm(`'${userToDelete.name}' íšŒì›ì„ ì •ë§ë¡œ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?`)) {
            const result = await callAPI('delete', 'Users', { rowIndex: userToDelete.originalIndex });
            if (result && result.success) {
                alert('ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.');
                allUsers = [];
                await renderAdminTable();
            }
        }
    }
    window.deleteUser = deleteUser;

    // === ë°ì´í„° ë¡œë”© ===
    async function loadUsers() {
        if (allUsers.length > 0) return;
        const users = await callAPI('readAll', 'Users');
        if (users) allUsers = users;
    }

    async function loadInitialData(page = 1, filter = currentFilter) {
        currentPage = page;
        currentFilter = filter;
        if (allUsers.length === 0) await loadUsers();

        let effectiveFilter = { ...filter };
        
        // ì „ë¬¸ìœ„ì› ë¡œê·¸ì¸ ì‹œ: Wì—´(ë‹´ë‹¹ ì „ë¬¸ìœ„ì›)ì´ ë³¸ì¸ ì´ë¦„ì¸ í–‰ë§Œ í•„í„°ë§
        if (loggedInUser.role === 'ì „ë¬¸ìœ„ì›') {
            effectiveFilter['ë‹´ë‹¹ ì „ë¬¸ìœ„ì›'] = loggedInUser.name;
        }

        const result = await callAPI('read', 'Companies', { page, limit: companiesLimit, filter: effectiveFilter });

        if (result) {
            allCompanies = result.data;
            totalCompanies = result.total;
            
            // ìºì‹œ ì—…ë°ì´íŠ¸ (í˜„ì¬ í˜ì´ì§€ ë°ì´í„° ì¶”ê°€)
            result.data.forEach(company => {
                const existIdx = cachedAllCompanies.findIndex(c => c.originalIndex === company.originalIndex);
                if (existIdx >= 0) {
                    cachedAllCompanies[existIdx] = company;
                } else {
                    cachedAllCompanies.push(company);
                }
            });
            
            document.getElementById('data-count-display').textContent = `(ì´ ${totalCompanies}ê°œ)`;
            renderDbTable();
            renderPagination();
            document.getElementById('welcome-user').textContent = `${loggedInUser.name}(${loggedInUser.role})ë‹˜ í™˜ì˜í•©ë‹ˆë‹¤`;
            document.getElementById('admin-page-button').classList.toggle('hidden', loggedInUser.role !== 'admin');
        }
    }

    // === DB í…Œì´ë¸” ë Œë”ë§ ===
    function renderDbTable() {
        const tableBody = document.getElementById('db-table-body');
        tableBody.innerHTML = '';

        if (allCompanies.length === 0) {
            tableBody.innerHTML = `<tr><td colspan="19" class="text-center py-10 text-slate-500">í‘œì‹œí•  ê¸°ì—… ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤.</td></tr>`;
            return;
        }

        // í‘œì‹œí•  ì»¬ëŸ¼
        const headers = [
            'ê¸°ì—…ëª…', 'ì—…ì¢…', 'ê¸°ì—…ê·œëª¨', 'íšŒì‚¬ì£¼ì†Œ', 'ì—°êµ¬ì†Œì£¼ì†Œ', 'êµ¬ë¶„', 'íšŒì‚¬Tel', 'íšŒì‚¬Fax', 'ëŒ€í‘œìëª…', 'ë‹´ë‹¹ ì „ë¬¸ìœ„ì›',
            'ì½œì¼ì', 'í†µí™”ëŒ€ìƒì', 'ì§í•¨', 'í†µí™”ë‚´ìš©_ì „ë¬¸ìœ„ì›', 'ë³¸ì‚¬ìƒë‹´ìš”ì²­', 'í™ˆí˜ì´ì§€ì•ˆë‚´ì¼ì', 'í™ˆí˜ì´ì§€url',
            'ë³¸ì‚¬ë‹´ë‹¹ìë©”ëª¨'
        ];

        allCompanies.forEach((company, index) => {
            const row = document.createElement('tr');
            row.className = 'cursor-pointer hover:bg-amber-50 border-b';
            row.onclick = () => openEditModal(company.originalIndex);

            let rowHtml = `<td class="px-3 py-2 whitespace-nowrap">${(currentPage - 1) * companiesLimit + index + 1}</td>`;
            
            headers.forEach(header => {
                let cellValue = company[header] || '';
                // ê¸´ í…ìŠ¤íŠ¸ëŠ” ì¤„ì„
                if (typeof cellValue === 'string' && cellValue.length > 30) {
                    cellValue = cellValue.substring(0, 30) + '...';
                }
                rowHtml += `<td class="px-3 py-2 whitespace-nowrap">${cellValue}</td>`;
            });
            
            row.innerHTML = rowHtml;
            tableBody.appendChild(row);
        });
    }

    // === í˜ì´ì§€ë„¤ì´ì…˜ ===
    function renderPagination() {
        const totalPages = Math.ceil(totalCompanies / companiesLimit);
        const controls = document.getElementById('page-buttons-container');
        controls.innerHTML = '';

        if (totalPages <= 1) return;

        const createButton = (text, page, isDisabled = false, isCurrent = false) => {
            const button = document.createElement('button');
            button.innerHTML = text;
            button.disabled = isDisabled;
            let styles = 'px-3 py-1 rounded text-sm font-medium transition-colors ';
            if (isCurrent) styles += 'bg-slate-800 text-white cursor-default';
            else if (isDisabled) styles += 'bg-slate-200 text-slate-400 cursor-not-allowed';
            else styles += 'bg-white text-slate-700 hover:bg-slate-100 border';
            button.className = styles;
            if (!isDisabled && !isCurrent) button.onclick = () => loadInitialData(page);
            return button;
        };

        controls.appendChild(createButton('â—€', currentPage - 1, currentPage === 1));

        let startPage, endPage;
        if (totalPages <= 7) { startPage = 1; endPage = totalPages; }
        else {
            if (currentPage <= 4) { startPage = 1; endPage = 7; }
            else if (currentPage + 3 >= totalPages) { startPage = totalPages - 6; endPage = totalPages; }
            else { startPage = currentPage - 3; endPage = currentPage + 3; }
        }

        if (startPage > 1) {
            controls.appendChild(createButton(1, 1));
            if (startPage > 2) controls.insertAdjacentHTML('beforeend', `<span class="px-2">...</span>`);
        }
        for (let i = startPage; i <= endPage; i++) {
            controls.appendChild(createButton(i, i, false, i === currentPage));
        }
        if (endPage < totalPages) {
            if (endPage < totalPages - 1) controls.insertAdjacentHTML('beforeend', `<span class="px-2">...</span>`);
            controls.appendChild(createButton(totalPages, totalPages));
        }

        controls.appendChild(createButton('â–¶', currentPage + 1, currentPage === totalPages));
    }
    window.renderPagination = renderPagination;

    function jumpToPage() {
        const totalPages = Math.ceil(totalCompanies / companiesLimit);
        const pageInput = document.getElementById('page-jump-input');
        const page = parseInt(pageInput.value);
        if (isNaN(page) || page < 1 || page > totalPages) {
            alert(`1ì—ì„œ ${totalPages} ì‚¬ì´ì˜ í˜ì´ì§€ ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.`);
            pageInput.value = '';
            return;
        }
        loadInitialData(page);
    }
    window.jumpToPage = jumpToPage;

    function searchCompany() {
        const column = document.getElementById('search-column-select').value;
        const searchTerm = document.getElementById('search-input').value;
        currentFilter = { [column]: searchTerm };
        loadInitialData(1, currentFilter);
    }
    window.searchCompany = searchCompany;

    function resetSearch() {
        document.getElementById('search-input').value = '';
        currentFilter = {};
        loadInitialData(1, currentFilter);
    }
    window.resetSearch = resetSearch;

    // === ëª¨ë‹¬ ë¡œì§ ===
    async function openEditModal(originalIndex) {
        // ë¨¼ì € í˜„ì¬ í˜ì´ì§€ ë°ì´í„°ì—ì„œ ì°¾ê¸°
        let company = allCompanies.find(c => c.originalIndex === originalIndex);
        
        // ì—†ìœ¼ë©´ ìºì‹œì—ì„œ ì°¾ê¸°
        if (!company && cachedAllCompanies.length > 0) {
            company = cachedAllCompanies.find(c => c.originalIndex === originalIndex);
        }
        
        // ê·¸ë˜ë„ ì—†ìœ¼ë©´ API í˜¸ì¶œ
        if (!company) {
            showLoading();
            const fullList = await callAPI('readAll', 'Companies');
            hideLoading();
            if (fullList) {
                cachedAllCompanies = fullList;
                company = fullList.find(c => c.originalIndex === originalIndex);
            }
        }
        
        if (company) {
            const form = document.getElementById('edit-form');
            form.reset();
            
            for (const key in company) {
                if (form.elements[key]) {
                    form.elements[key].value = company[key] || '';
                }
            }
            
            form.elements['originalIndex'].value = originalIndex;
            document.getElementById('modal-title').textContent = `[${company['ê¸°ì—…ëª…'] || 'ë¯¸ì…ë ¥'}] ìƒì„¸ ì •ë³´`;
            document.getElementById('delete-button').classList.add('hidden');
            
            applyRolePermissions();
            document.getElementById('edit-modal').classList.remove('hidden');
        } else {
            alert('í•´ë‹¹ ê¸°ì—… ì •ë³´ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
        }
    }
    window.openEditModal = openEditModal;

    function openNewCompanyModal() {
        const form = document.getElementById('edit-form');
        form.reset();
        form.elements['originalIndex'].value = '';
        document.getElementById('modal-title').textContent = 'ì‹ ê·œ ê¸°ì—… ë“±ë¡';
        document.getElementById('delete-button').classList.add('hidden');
        applyRolePermissions();
        document.getElementById('edit-modal').classList.remove('hidden');
    }
    window.openNewCompanyModal = openNewCompanyModal;

    function closeEditModal() {
        document.getElementById('edit-modal').classList.add('hidden');
    }
    window.closeEditModal = closeEditModal;

    async function saveModalData() {
        const form = document.getElementById('edit-form');
        const formData = new FormData(form);
        const newData = {};
        for (let [key, value] of formData.entries()) newData[key] = value;
        
        const originalIndexValue = newData.originalIndex;
        const originalIndex = (originalIndexValue !== '' && !isNaN(parseInt(originalIndexValue))) ? parseInt(originalIndexValue) : null;
        delete newData.originalIndex;

        const action = (originalIndex !== null) ? 'update' : 'write';
        const payload = { data: newData, rowIndex: originalIndex };

        const result = await callAPI(action, 'Companies', payload);

        if (result && result.success) {
            alert('ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤!');
            closeEditModal();
            cachedAllCompanies = []; // ìºì‹œ ì´ˆê¸°í™”
            await loadInitialData(action === 'update' ? currentPage : 1);
        }
    }
    window.saveModalData = saveModalData;

    async function deleteCompany() {
        const originalIndex = document.querySelector('#edit-form input[name="originalIndex"]').value;
        if (originalIndex === '' || originalIndex === null) return;
        if (confirm('ì •ë§ë¡œ ì´ ê¸°ì—… ì •ë³´ë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
            const result = await callAPI('delete', 'Companies', { rowIndex: parseInt(originalIndex) });
            if (result && result.success) {
                alert('ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.');
                closeEditModal();
                await loadInitialData(1);
            }
        }
    }
    window.deleteCompany = deleteCompany;

    // === ê¶Œí•œ ì„¤ì • ===
    function applyRolePermissions() {
        const form = document.getElementById('edit-form');
        
        // ê¸°ë³¸ì •ë³´ëŠ” í•­ìƒ ì½ê¸° ì „ìš©
        form.querySelector('#company-info-fieldset').querySelectorAll('input, select, textarea').forEach(el => {
            el.readOnly = true;
            el.disabled = false;
        });
        
        if (loggedInUser.role === 'admin') {
            // ê´€ë¦¬ì: ëª¨ë“  í•„ë“œ í¸ì§‘ ê°€ëŠ¥
            form.querySelectorAll('fieldset').forEach(fs => {
                fs.querySelectorAll('input, select, textarea').forEach(el => {
                    el.readOnly = false;
                    el.disabled = false;
                });
            });
        } else if (loggedInUser.role === 'ì „ë¬¸ìœ„ì›') {
            // ì „ë¬¸ìœ„ì›: ê¸°ë³¸ì •ë³´ ì½ê¸°ì „ìš©, ì „ë¬¸ìœ„ì› ì…ë ¥í•­ëª©ë§Œ í¸ì§‘ ê°€ëŠ¥
            form.querySelector('#specialist-fieldset').querySelectorAll('input, select, textarea').forEach(el => {
                el.readOnly = false;
                el.disabled = false;
            });
            // ë³¸ì‚¬ ì…ë ¥í•­ëª©ì€ ì „ë¬¸ìœ„ì›ì´ ìˆ˜ì • ë¶ˆê°€
            form.querySelector('#hq-fieldset').querySelectorAll('input, select, textarea').forEach(el => {
                el.readOnly = true;
                el.disabled = false;
                el.classList.add('bg-gray-100');
            });
        }
    }

    function handleEnterKey(event) {
        if (event.key === 'Enter' && event.target.tagName.toLowerCase() !== 'textarea') {
            if (event.target.tagName.toLowerCase() === 'select') return;
            event.preventDefault();
            const form = event.target.form;
            const fields = Array.from(form.querySelectorAll('input:not([readonly]):not([type=hidden]), select, textarea')).filter(el => !el.disabled);
            const currentIndex = fields.indexOf(event.target);
            const nextIndex = currentIndex + 1;
            if (nextIndex < fields.length) fields[nextIndex].focus();
        }
    }
    window.handleEnterKey = handleEnterKey;

    const tooltip = document.getElementById('global-tooltip');
    function showTooltip(iconElement, text) {
        tooltip.innerHTML = text;
        tooltip.style.visibility = 'visible';
        tooltip.style.opacity = '1';
        const rect = iconElement.getBoundingClientRect();
        let top = rect.top - tooltip.offsetHeight - 10;
        if (top < 10) top = rect.bottom + 10;
        let left = rect.left + (rect.width / 2) - (tooltip.offsetWidth / 2);
        if (left < 10) left = 10;
        else if (left + tooltip.offsetWidth > window.innerWidth - 10) left = window.innerWidth - tooltip.offsetWidth - 10;
        tooltip.style.top = `${top}px`;
        tooltip.style.left = `${left}px`;
    }
    window.showTooltip = showTooltip;

    function hideTooltip() {
        tooltip.style.visibility = 'hidden';
        tooltip.style.opacity = '0';
    }
    window.hideTooltip = hideTooltip;

    // === Schedule ê´€ë ¨ í•¨ìˆ˜ ===
    // 2025-2026 í•œêµ­ ê³µíœ´ì¼ ëª©ë¡
    const koreanHolidays = [
        '2025-01-01', '2025-01-28', '2025-01-29', '2025-01-30', // ì‹ ì •, ì„¤ë‚ 
        '2025-03-01', '2025-05-05', '2025-05-06', '2025-06-06', // ì‚¼ì¼ì ˆ, ì–´ë¦°ì´ë‚ , ëŒ€ì²´íœ´ì¼, í˜„ì¶©ì¼
        '2025-08-15', '2025-10-03', '2025-10-05', '2025-10-06', '2025-10-07', // ê´‘ë³µì ˆ, ê°œì²œì ˆ, ì¶”ì„
        '2025-10-09', '2025-12-25', // í•œê¸€ë‚ , ì„±íƒ„ì ˆ
        '2026-01-01', '2026-02-16', '2026-02-17', '2026-02-18', // ì‹ ì •, ì„¤ë‚ 
        '2026-03-01', '2026-03-02', '2026-05-05', '2026-05-24', '2026-06-06', // ì‚¼ì¼ì ˆ, ëŒ€ì²´íœ´ì¼, ì–´ë¦°ì´ë‚ , ë¶€ì²˜ë‹˜ì˜¤ì‹ ë‚ , í˜„ì¶©ì¼
        '2026-08-15', '2026-08-17', '2026-09-24', '2026-09-25', '2026-09-26', // ê´‘ë³µì ˆ, ëŒ€ì²´íœ´ì¼, ì¶”ì„
        '2026-10-03', '2026-10-05', '2026-10-09', '2026-12-25' // ê°œì²œì ˆ, ëŒ€ì²´íœ´ì¼, í•œê¸€ë‚ , ì„±íƒ„ì ˆ
    ];

    function getNextWeekDates() {
        const today = new Date();
        const dayOfWeek = today.getDay(); // 0(ì¼) ~ 6(í† )
        const daysUntilNextMonday = dayOfWeek === 0 ? 1 : 8 - dayOfWeek;
        const nextMonday = new Date(today);
        nextMonday.setDate(today.getDate() + daysUntilNextMonday);
        
        const dates = [];
        const weekdays = ['ì¼', 'ì›”', 'í™”', 'ìˆ˜', 'ëª©', 'ê¸ˆ', 'í† '];
        for (let i = 0; i < 5; i++) { // ì›”~ê¸ˆ
            const date = new Date(nextMonday);
            date.setDate(nextMonday.getDate() + i);
            const dateStr = date.toISOString().split('T')[0];
            const isHoliday = koreanHolidays.includes(dateStr);
            dates.push({
                date: dateStr,
                display: `${date.getMonth() + 1}/${date.getDate()}(${weekdays[date.getDay()]})`,
                isHoliday: isHoliday
            });
        }
        return dates;
    }

    async function renderScheduleUI() {
        if (loggedInUser.role !== 'ì „ë¬¸ìœ„ì›') return;
        
        document.getElementById('specialist-schedule-section').classList.remove('hidden');
        
        const container = document.getElementById('schedule-checkboxes');
        const dates = getNextWeekDates();
        
        container.innerHTML = dates.map(d => `
            <label class="flex items-center gap-2 p-3 border rounded-lg cursor-pointer hover:bg-slate-50 ${d.isHoliday ? 'opacity-50 bg-red-50' : ''}">
                <input type="checkbox" name="schedule-date" value="${d.date}" 
                    ${d.isHoliday ? 'disabled' : ''} class="w-5 h-5 text-amber-500">
                <span class="${d.isHoliday ? 'text-red-500 line-through' : ''}">${d.display}</span>
                ${d.isHoliday ? '<span class="text-xs text-red-500">(ê³µíœ´ì¼)</span>' : ''}
            </label>
        `).join('');
        
        await renderMyScheduleStatus();
    }

    async function renderMyScheduleStatus() {
        const listContainer = document.getElementById('my-schedule-list');
        const schedules = await callAPI('readAll', 'Schedule');
        
        if (!schedules || schedules.length === 0) {
            listContainer.innerHTML = '<span class="text-sm text-slate-500">ì‹ ì²­ ë‚´ì—­ì´ ì—†ìŠµë‹ˆë‹¤.</span>';
            return;
        }
        
        const mySchedules = schedules.filter(s => s['ì „ë¬¸ìœ„ì›ì„±ëª…'] === loggedInUser.name);
        
        if (mySchedules.length === 0) {
            listContainer.innerHTML = '<span class="text-sm text-slate-500">ì‹ ì²­ ë‚´ì—­ì´ ì—†ìŠµë‹ˆë‹¤.</span>';
            return;
        }
        
        listContainer.innerHTML = mySchedules.map(s => {
            const status = s['ìƒíƒœ'] || 'ì‹ ì²­';
            let statusClass = 'bg-yellow-100 text-yellow-800';
            let statusIcon = 'â³';
            if (status === 'í™•ì •') {
                statusClass = 'bg-green-100 text-green-800';
                statusIcon = 'âœ…';
            } else if (status === 'ì·¨ì†Œ') {
                statusClass = 'bg-red-100 text-red-800';
                statusIcon = 'âŒ';
            }
            return `<span class="px-3 py-1 rounded-full text-sm ${statusClass}">${statusIcon} ${s['ì‹ ì²­ì¼ì']} (${status})</span>`;
        }).join('');
    }

    async function saveSchedule() {
        const checkboxes = document.querySelectorAll('input[name="schedule-date"]:checked');
        if (checkboxes.length === 0) {
            alert('ì½œ ê°€ëŠ¥í•œ ë‚ ì§œë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”.');
            return;
        }
        
        const selectedDates = Array.from(checkboxes).map(cb => cb.value);
        
        // ê¸°ì¡´ ì‹ ì²­ ëª©ë¡ ê°€ì ¸ì˜¤ê¸°
        const existingSchedules = await callAPI('readAll', 'Schedule');
        const myExisting = existingSchedules ? existingSchedules.filter(s => s['ì „ë¬¸ìœ„ì›ì„±ëª…'] === loggedInUser.name).map(s => s['ì‹ ì²­ì¼ì']) : [];
        
        let successCount = 0;
        for (const date of selectedDates) {
            if (myExisting.includes(date)) continue; // ì´ë¯¸ ì‹ ì²­í•œ ë‚ ì§œëŠ” ê±´ë„ˆëœ€
            
            const scheduleData = {
                'ì „ë¬¸ìœ„ì›ì„±ëª…': loggedInUser.name,
                'ì‹ ì²­ì¼ì': date,
                'ìƒíƒœ': 'ì‹ ì²­',
                'ì²˜ë¦¬ì¼ì‹œ': ''
            };
            const result = await callAPI('write', 'Schedule', { data: scheduleData });
            if (result && result.success) successCount++;
        }
        
        if (successCount > 0) {
            alert(`${successCount}ê°œ ì¼ì •ì´ ì‹ ì²­ë˜ì—ˆìŠµë‹ˆë‹¤.`);
            // ì²´í¬ë°•ìŠ¤ ì´ˆê¸°í™”
            document.querySelectorAll('input[name="schedule-date"]').forEach(cb => cb.checked = false);
            await renderMyScheduleStatus();
        } else {
            alert('ì´ë¯¸ ì‹ ì²­ëœ ì¼ìì´ê±°ë‚˜ ì‹ ì²­ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');
        }
    }
    window.saveSchedule = saveSchedule;

    // ê´€ë¦¬ììš© ìŠ¤ì¼€ì¤„ ê´€ë¦¬
    async function renderAdminSchedule() {
        const tbody = document.getElementById('admin-schedule-body');
        const noMsg = document.getElementById('no-schedule-msg');
        
        const schedules = await callAPI('readAll', 'Schedule');
        
        if (!schedules || schedules.length === 0) {
            tbody.innerHTML = '';
            noMsg.classList.remove('hidden');
            document.getElementById('admin-schedule-container').classList.add('hidden');
            return;
        }
        
        noMsg.classList.add('hidden');
        document.getElementById('admin-schedule-container').classList.remove('hidden');
        
        tbody.innerHTML = schedules.map((s, idx) => {
            const status = s['ìƒíƒœ'] || 'ì‹ ì²­';
            let statusBadge = '<span class="px-2 py-1 rounded-full text-xs bg-yellow-100 text-yellow-800">â³ ì‹ ì²­</span>';
            if (status === 'í™•ì •') {
                statusBadge = '<span class="px-2 py-1 rounded-full text-xs bg-green-100 text-green-800">âœ… í™•ì •</span>';
            } else if (status === 'ì·¨ì†Œ') {
                statusBadge = '<span class="px-2 py-1 rounded-full text-xs bg-red-100 text-red-800">âŒ ì·¨ì†Œ</span>';
            }
            
            const showButtons = status === 'ì‹ ì²­';
            
            return `
                <tr class="bg-white border-b">
                    <td class="px-4 py-3 font-semibold">${s['ì „ë¬¸ìœ„ì›ì„±ëª…']}</td>
                    <td class="px-4 py-3">${s['ì‹ ì²­ì¼ì']}</td>
                    <td class="px-4 py-3">${statusBadge}</td>
                    <td class="px-4 py-3 text-sm text-slate-500">${s['ì²˜ë¦¬ì¼ì‹œ'] || '-'}</td>
                    <td class="px-4 py-3 text-center">
                        ${showButtons ? `
                            <button onclick="updateScheduleStatus(${s.originalIndex}, 'í™•ì •')" class="px-2 py-1 text-xs font-semibold rounded bg-green-500 text-white hover:bg-green-600 mr-1">í™•ì •</button>
                            <button onclick="updateScheduleStatus(${s.originalIndex}, 'ì·¨ì†Œ')" class="px-2 py-1 text-xs font-semibold rounded bg-red-500 text-white hover:bg-red-600">ì·¨ì†Œ</button>
                        ` : '<span class="text-xs text-slate-400">ì²˜ë¦¬ì™„ë£Œ</span>'}
                    </td>
                </tr>
            `;
        }).join('');
    }
    window.renderAdminSchedule = renderAdminSchedule;

    async function updateScheduleStatus(rowIndex, newStatus) {
        // ê¸°ì¡´ ë°ì´í„° ê°€ì ¸ì˜¤ê¸°
        const schedules = await callAPI('readAll', 'Schedule');
        const targetSchedule = schedules.find(s => s.originalIndex === rowIndex);
        
        if (!targetSchedule) {
            alert('í•´ë‹¹ ìŠ¤ì¼€ì¤„ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
            return;
        }
        
        const now = new Date();
        const timestamp = `${now.getFullYear()}-${String(now.getMonth()+1).padStart(2,'0')}-${String(now.getDate()).padStart(2,'0')} ${String(now.getHours()).padStart(2,'0')}:${String(now.getMinutes()).padStart(2,'0')}`;
        
        // ê¸°ì¡´ ë°ì´í„° ìœ ì§€í•˜ë©´ì„œ ìƒíƒœì™€ ì²˜ë¦¬ì¼ì‹œë§Œ ì—…ë°ì´íŠ¸
        const result = await callAPI('update', 'Schedule', {
            rowIndex: rowIndex,
            data: {
                'ì „ë¬¸ìœ„ì›ì„±ëª…': targetSchedule['ì „ë¬¸ìœ„ì›ì„±ëª…'],
                'ì‹ ì²­ì¼ì': targetSchedule['ì‹ ì²­ì¼ì'],
                'ìƒíƒœ': newStatus,
                'ì²˜ë¦¬ì¼ì‹œ': timestamp
            }
        });
        
        if (result && result.success) {
            alert(`${newStatus} ì²˜ë¦¬ë˜ì—ˆìŠµë‹ˆë‹¤.`);
            await renderAdminSchedule();
        }
    }
    window.updateScheduleStatus = updateScheduleStatus;

    // === í˜ì´ì§€ ì²« ë¡œë“œ ===
    document.addEventListener('DOMContentLoaded', () => {
        const savedUser = sessionStorage.getItem('loggedInUser');
        if (savedUser) {
            loggedInUser = JSON.parse(savedUser);
            if (loggedInUser.role === 'admin') {
                showPage('admin-page');
            } else {
                showPage('TM-DB-Table');
            }
        } else {
            showPage('login-page');
        }
    });
</script>
</body>
</html>
